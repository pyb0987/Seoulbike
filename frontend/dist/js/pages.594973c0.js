(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages"],{"0025":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("div",{staticClass:"typography-line"}),r("send-code",{attrs:{number:"24"}},[t._v(" monthly_members = new_members.groupby(['가입연도', '가입월']).sum()"),r("br"),t._v(" monthly_members = monthly_members.reset_index()"),r("br"),t._v(" monthly_members['가입연월'] = monthly_members['가입연도']+plotdf['가입월']"),r("br"),t._v(' fig = px.bar(monthly_members, x=\'가입연월\', y="가입수", labels=dict(x="가입연월"))'),r("br"),t._v(" fig.update_layout(title_text='연월별 신규 가입인원')"),r("br"),t._v(" fig.show()"),r("br"),t._v(" fig = TimeSeriesPlot(plotdf, '가입연도', '가입월', '가입수', title='1년 주기 월별 가입인원 추이')"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"col-6",attrs:{data:"http://localhost:8000/static/figures/monthly_members.html",height:"500",type:"text/html"}}),r("object",{staticClass:"col-6",attrs:{data:"http://localhost:8000/static/figures/yearly_members.html",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 왼쪽의 그래프는 월별로 신규가입인원을 나타낸 것이고, 오른쪽의 그래프는 같은 것을 12개월 단위로 쪼개어 선그래프로 나타낸 것이다. 가입인원의 그래프는 확실하게 계절적 주기성을 띄고 있는 것을 볼 수 있다. 추운계절인 11월부터 3월까지는 신규인원들이 자전거를 대여할 동기부여가 떨어지는 것을 확인 할 수 있다. 그 차이는 생각한 것보다도 훨씬 컸는데, 이는 (당연히 고려해야 하지만) 계절적인 특성을 구하고자 하는 '대여소별 자전거 대수예측'에 반영해야하며 시계열 분석으로 예측을 해야할 수도 있다는 생각을 하게 만들었다."),r("br"),r("br"),t._v(" 또 가입인원은 그 이후로 계속 증가하다 7, 8월은 오히려 떨어지는 것을 볼 수 있는데, 이는 자전거를 타기에 비교적으로 더운 날씨이기 때문인 것으로 보인다. 자전거를 대여할 동기부여는 계절적(또는 온도적) 특성에 지대한 영향을 받는다는 인사이트를 도출할 수 있다."),r("br"),r("br"),t._v(" 또 가입인원이 2020년에 정점을 찍고 점점 내려오는 것이 확인된다. ")])]),r("send-code",{attrs:{number:"25"}},[t._v(" monthly_spot = pd.DataFrame(share_spot.groupby(['연', '월']).size())"),r("br"),t._v(" monthly_spot.columns = ['설치 대수']"),r("br"),t._v(" monthly_spot['연'] = monthly_spot.index.get_level_values(0)"),r("br"),t._v(" monthly_spot['월'] = monthly_spot.index.get_level_values(1)"),r("br"),t._v(" monthly_spot['설치연월'] = monthly_spot['연']+monthly_spot['월']"),r("br"),t._v(" monthly_spot = pd.merge(left = monthly_members['가입연월'], right = monthly_spot, how='left', left_on = '가입연월', right_on='설치연월').fillna(0)"),r("br"),t._v(" monthly_spot.drop('설치연월', axis=1, inplace=True)"),r("br"),t._v(" monthly_spot.columns = ['설치연월', '설치 대수', '연', '월']"),r("br"),r("br"),t._v(" fig = px.bar(monthly_spot, x='설치연월', y=\"설치 대수\")"),r("br"),t._v(" fig.update_layout(title_text='연월별 대여소 설치 대수')"),r("br"),t._v(" fig.show() ")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/monthly_spot.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 연월별 따릉이 대여소 설치 건수는 신규가입인원의 추이와 별로 연관이 없는 것처럼 보인다. 당연히 대여소가 늘어나면 신규가입인원도 늘겠지만(접할 기회가 더 많아지므로) 그 증가의 방식이 두 그래프에서 서로 관계가 없는 것처럼 보인다. 아마 신규가입인원이 2020년까지 매년 증가하고 2021년부터는 그 수가 줄은 이유는 따릉이 사업이 그 외연을 확장하는 동안 계속 신규 유입이 되다가 이제 안정기에 들어선 것으로 사료된다."),r("br"),r("br"),t._v(" 또는 이를 천천히 올라가는 그래프로 보고 2020년만 높은 이유를 설명하는 변수로 코로나의 발발을 들수도 있겠다. 그렇게 해석할 경우, 평시 신규가입자 수는 계속 비슷한 수준을 유지할 것이며 사업의 미래가 밝다는 것을 암시할 수도 있다. ")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-009",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},"041a":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("send-code",{attrs:{number:"10"}},[t._v(" N=7"),r("br"),t._v(" c = ['hsl('+str(h)+',50%'+',50%)' for h in np.linspace(0, 360, N)]"),r("br"),t._v(" week = ['월','화','수','목','금','토','일']"),r("br"),t._v(" fig = go.Figure(data=[go.Violin("),r("br"),t._v("     y=monthly_use[monthly_use['대여요일']==week[i]]['이용건수'],"),r("br"),t._v("     marker_color=c[i],"),r("br"),t._v("     name= week[i]"),r("br"),t._v("     ) for i in range(int(N))])"),r("br"),r("br"),t._v(" # format the layout"),r("br"),t._v(" fig.update_traces(box_visible=True, meanline_visible=True)"),r("br"),t._v(" fig.update_layout("),r("br"),t._v("     xaxis=dict(showgrid=False, zeroline=False, showticklabels=False),"),r("br"),t._v("     yaxis=dict(zeroline=False, gridcolor='white'),"),r("br"),r("br"),t._v("     title='주별 자전거 이용량'"),r("br"),t._v(" )"),r("br"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/weekly_use.html",width:"800",height:"480",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v("주별로 전체적인 추이를 보는 것은 그렇게 가시적인 인사이트를 주지 못하는 것 같다. 겨울인 주와 여름인 주가 모두 있기 때문에 꼬리가 길게 늘어진다. 다만 화, 토, 일은 비교적으로 사람들이 '안타는 선택을 하는 경우'가 있으며 월, 수,목, 금요일은 위쪽으로 조금 몰려있는 것으로 보아, 이때 타는 사람들은 '정말 자전거를 좋아하는 사람들'으로 해석할 수 있을 것처럼 보인다. ")])]),r("send-code",{attrs:{number:"11"}},[t._v(" weekly_use_type = daily_use_df.groupby(['대여요일','대여구분코드']).sum().reset_index()"),r("br"),t._v(" fig = px.bar(weekly_use_type.loc[:,['대여요일','대여구분코드','이용건수']], x='대여요일', y='이용건수', color='대여구분코드', title=\"요일별 대여구분코드에 따른 이용건수\")"),r("br"),t._v(" fig.update_layout(xaxis={'categoryorder':'array', 'categoryarray':week})"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/weekly_use_type.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 대여구분코드에 따른 요일별 차이를 보았더니 어떤 점이 눈에 띈다. 자전거타기를 좋아하는 '정기권'층은 오히려 토, 일요일에는 잘 타지 않는 것으로 드러났다. 정기권을 뺀 나머지는 일요일의 이용건수가 월요일의 최대 두 배까지 올라가지만, 평일에도 자전거를 이용하는 '정기권'층은 일요일에 2/3수준으로 줄어드는 것을 볼 수 있다."),r("br"),r("br"),t._v(" 따라서 자전거를 자주타는'정기권'층은 자전거를 타는 것을 여가로 하는 비율은 더 적다는 것을 추측할 수 있다. 정기권이 대여소별 이용량에 주는 영향은 평일에 극대화되지만, 주말에는 조금 다른 접근법을 적용해야 함을 알 수 있다."),r("br"),r("br")])]),r("send-code",{attrs:{number:"12"}},[t._v(" weekly_use_type['평균 이용시간(분)'] = weekly_use_type['이용시간(분)']/weekly_use_type['이용건수']"),r("br"),t._v(" weekly_use_type['평균 이동거리(m)'] = weekly_use_type['이동거리(m)']/weekly_use_type['이용건수']"),r("br"),t._v(" fig = go.Figure()"),r("br"),t._v(" fig.add_trace(go.Bar("),r("br"),t._v("     x=weekly_use_type[weekly_use_type['대여구분코드']=='정기']['대여요일'],"),r("br"),t._v("     y=weekly_use_type[weekly_use_type['대여구분코드']=='정기']['평균 이용시간(분)'],"),r("br"),t._v("     name='정기',"),r("br"),t._v("     marker_color='midnightblue'"),r("br"),t._v(" ))"),r("br"),t._v(" fig.add_trace(go.Bar("),r("br"),t._v("     x=weekly_use_type[weekly_use_type['대여구분코드']=='일일권']['대여요일'],"),r("br"),t._v("     y=weekly_use_type[weekly_use_type['대여구분코드']=='일일권']['평균 이용시간(분)'],"),r("br"),t._v("     name='일일권',"),r("br"),t._v("     marker_color='lightslategray'"),r("br"),t._v(" ))"),r("br"),t._v(" fig.add_trace(go.Bar("),r("br"),t._v("     x=weekly_use_type[weekly_use_type['대여구분코드']=='비회원']['대여요일'],"),r("br"),t._v("     y=weekly_use_type[weekly_use_type['대여구분코드']=='비회원']['평균 이용시간(분)'],"),r("br"),t._v("     name='비회원',"),r("br"),t._v("     marker_color='lightsalmon'"),r("br"),t._v(" ))"),r("br"),t._v(" fig.add_trace(go.Bar("),r("br"),t._v("     x=weekly_use_type[weekly_use_type['대여구분코드']=='단체']['대여요일'],"),r("br"),t._v("     y=weekly_use_type[weekly_use_type['대여구분코드']=='단체']['평균 이용시간(분)'],"),r("br"),t._v("     name='단체',"),r("br"),t._v("     marker_color='indianred',"),r("br"),t._v(" ))"),r("br"),r("br"),r("br"),t._v(" fig.update_layout(title='요일별 대여구분코드에 따른 이용시간', barmode='group', xaxis={'categoryorder':'array', 'categoryarray':week})"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/weekly_use_type_time.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 그와 비슷하게, 이용시간을 대상으로 한 비교에서도 정기권 유저들은 자전거를 적게 타는 것을 알 수 있었다. 특히나 모든 요일에 대해서 더 타는 시간이 적었다. 따릉이를 정기권으로 이용하는 사람들은 '이동의 목적을 가지고 자주타겠다는 목적으로 정기권을 사는 경우'가 흔하기 때문이라고 추측한다."),r("br"),r("br"),t._v(" 따릉이를 정기적으로 이용하는 사람들은(전체의 75%) 따릉이를 이용의 목적으로 이용하는 경향이 강하다면, 그 변화를 감지하는 것이 목표인 우리에게는 희소식이 아닐 수 없다. ")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-003",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},"0e3a":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("div",{staticClass:"typography-line"},[r("h3",[t._v("대여소 톺아보기")]),r("p",[t._v("대여소 정보는 "),r("a",{attrs:{href:"https://data.seoul.go.kr/dataList/datasetList.do#",target:"_blank"}},[t._v(" https://data.seoul.go.kr/dataList/datasetList.do#")]),t._v("에서 가져와 분석을 위해 결측값을 제거했다.")])]),r("send-code",{attrs:{number:"7"}},[t._v(" share_spot = pd.read_csv(data_dir + '대여소\\대여소정보.csv',engine='python',encoding='CP949', index_col=0)"),r("br"),t._v(" share_spot[['LCD', 'QR']] = share_spot[['LCD', 'QR']].fillna(0).astype(int)"),r("br"),t._v(" share_spot['설치시기'].fillna(method='bfill', inplace = True)"),r("br"),t._v(" share_spot.drop(columns='운영방식',inplace = True)"),r("br"),t._v(" share_spot['연'] = share_spot['설치시기'].str.split('-').str[0]"),r("br"),t._v(" share_spot['월'] = share_spot['설치시기'].str.split('-').str[1]"),r("br"),t._v(" share_spot['일'] = share_spot['설치시기'].str.split('-').str[2]"),r("br"),t._v(" share_spot.drop(columns='설치시기',inplace = True)"),r("br"),t._v(" share_spot.info() ")]),r("receiveCode",[t._v(" Int64Index: 2653 entries, 102 to 5855"),r("br"),t._v(" Data columns (total 10 columns):"),r("br"),t._v(" # Column Non-Null Count Dtype "),r("br"),t._v(" --- ------ -------------- ----- "),r("br"),t._v(" 0 보관소(대여소)명 2653 non-null object "),r("br"),t._v(" 1 자치구 2653 non-null object "),r("br"),t._v(" 2 상세주소 2653 non-null object "),r("br"),t._v(" 3 위도 2653 non-null float64"),r("br"),t._v(" 4 경도 2653 non-null float64"),r("br"),t._v(" 5 LCD 2653 non-null float64"),r("br"),t._v(" 6 QR 2653 non-null float64"),r("br"),t._v(" 7 연 2653 non-null float64"),r("br"),t._v(" 8 월 2653 non-null float64"),r("br"),t._v(" 9 일 2653 non-null float64"),r("br"),t._v(" dtypes: float64(7), object(3)"),r("br"),t._v(" memory usage: 184.7+ KB"),r("br")]),r("send-code",{attrs:{number:"8"}},[t._v(" share_spot_map = heatMapMap(share_spot['위도'], share_spot['경도'])"),r("br"),t._v(" share_spot_map ")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/share_spot_map.html",width:"600",height:"600",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v("지도에 히트맵을 표시해본 결과는 다음과 같다. 사람이 많을 만한 공간에 많이 배치되어 있는 것을 알 수 있다. 충정로, 시청, 을지로, 종로 부근과, 김포국제공항 앞 공항대로의 밀도가 특히 높다. 강남구와 서초구에는 예상했던 것과는 반대로 그렇게 높은 밀도로 분포되어 있지는 않은 것이 보인다.")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-003",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},"137b":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("send-code",{attrs:{number:"29"}},[t._v(' fig = px.density_heatmap(pd.concat([hour_2021_대여, hour_2021_반납]), x="시", y="자치구", z="유입량", facet_row="요일", histfunc="avg")'),r("br"),t._v(" fig.update_layout(   "),r("br"),t._v("     width=900,"),r("br"),t._v("     height = 800,"),r("br"),t._v("     title='자치구별 시간별 대여소당 자전거 유입량 추이')"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/dist_hourly_inflow.html",width:"925",height:"830",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 자치구별로 유입량을 나눠서 살펴보면 큰 차이가 있는 지역들이 있었다. 예를들면 제일 노란색에 가까운 순으로 성동구, 영등포구, 중구 등은 사람들이 많이 도착하는 쪽이고 제일 파란색에 가까운 순으로 광진구, 서대문구, 성북구 등은 사람들이 많이 출발하는 편이었다. 본인은 광진구에 거주중이므로, 평일 아침에 자전거를 빌리기 위해 갔을 때 자전거가 없으면 기다려도 소용이 없다는 것을 알 수 있었다. 그러나 다수의 자치구는 별로 유입, 유출이 보이지 않는 듯 했다."),r("br"),r("br"),t._v(" 자치구의 비교에서 무언가를 얻을 수 있을 거라는 기대는 앞으로는 하지 않는 것이 낫겠다. 자치구 내의 주거지역에서 상업지역으로 출근하는 경향이 있다고 가정하면 그러므로 아마 자치구별 히트맵에서 기대하던 결과는, 개별 대여소에 대한 비교에서 볼 수 있을 것 같다. ")])]),r("send-code",{attrs:{number:"30"}},[t._v(" (time_split_2021['대여대여소번호']==time_split_2021['반납대여소번호']).value_counts() ")]),r("receive-code",[t._v(" False    23664913"),r("br"),t._v(" True      2530740"),r("br"),t._v(" dtype: int64"),r("br")]),r("send-code",{attrs:{number:"31"}},[t._v(" dist_hour_대여 = time_split_2021.copy()"),r("br"),t._v(" dist_hour_대여['대여요일'] = dist_hour_대여['대여요일'].replace({0: '평일',1: '평일',2: '평일',3: '평일',4: '평일',5: '휴일',6: '휴일' })"),r("br"),t._v(" dist_hour_대여 = dist_hour_대여.groupby(['대여요일', '대여시','대여대여소번호']).size()"),r("br"),t._v(" dist_hour_대여.name = '대여횟수'"),r("br"),t._v(" dist_hour_반납 = time_split_2021.copy()"),r("br"),t._v(" dist_hour_반납['반납요일'] = dist_hour_반납['반납요일'].replace({0: '평일',1: '평일',2: '평일',3: '평일',4: '평일',5: '휴일',6: '휴일' })"),r("br"),t._v(" dist_hour_반납 = dist_hour_반납.groupby(['반납요일', '반납시','반납대여소번호']).size()"),r("br"),t._v(" dist_hour_반납.name = '반납횟수'"),r("br"),r("br"),t._v(" dist_hour_대여반납 = pd.concat([dist_hour_대여,dist_hour_반납], axis=1)"),r("br"),t._v(" del dist_hour_대여"),r("br"),t._v(" del dist_hour_반납"),r("br"),t._v(" dist_hour_대여반납['유출량'] = dist_hour_대여반납['대여횟수'] - dist_hour_대여반납['반납횟수']"),r("br"),t._v(" dist_hour_대여반납 = dist_hour_대여반납.reset_index()"),r("br"),t._v(" dist_hour_대여반납.columns = ['이용요일', '이용시', '대여소', '대여횟수', '반납횟수', '유출량']"),r("br"),t._v(" dist_hour_대여반납 = dist_hour_대여반납[dist_hour_대여반납['이용요일']=='평일'].pivot(index='대여소',columns='이용시', values='유출량').fillna(0)"),r("br"),r("br"),t._v(" fig = dash_bio.Clustergram("),r("br"),t._v("     data=np.cbrt(dist_hour_대여반납),"),r("br"),t._v("     cluster='row',"),r("br"),t._v("     column_labels=list(dist_hour_대여반납.columns.values),"),r("br"),t._v("     row_labels=list(dist_hour_대여반납.index),"),r("br"),t._v("     height=800,"),r("br"),t._v("     width=1000,"),r("br"),t._v("      color_map= ["),r("br"),t._v('         [0.0, "#ffffff"],'),r("br"),t._v('         [0.35, "#e5e5e5"],'),r("br"),t._v('         [0.55, "#fca311"],'),r("br"),t._v('         [0.85, "#14213d"],'),r("br"),t._v('         [1.0, "#000000"]],'),r("br"),t._v("     hidden_labels='row',"),r("br"),r("br"),t._v(" )"),r("br"),t._v(" fig.update_layout(   "),r("br"),t._v("     title='시간별 대여소별 자전거 유입량 클러스터 맵')"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",staticStyle:{"background-color":"#fff"},attrs:{data:"http://localhost:8000/static/figures/dist_hourly_inflow_cluster.html",width:"1020",height:"830",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 유출량에 대한 클러스터맵을 작성했다. 편차가 매우 커서 나타낸 양은 유출량의 세제곱근이다. 유의미한 클러스터가 두개 관찰되는 것을 볼 수 있다. 위쪽은 오전에 많이 유출된 후 오후 유입되는 경향을 보이고 아래쪽은 오전에 많이 유입된 후, 오후 유출되는 경향을 보였다. 가운데에도 클러스터가 하나 있는 것처럼 보인다. 시간대에 고르게 유출관 유입이 있는 대여소들이다. 그러나 차트의 클러스터 생성함수에는 감지되지 않았다. 어느 시간대에서나 빠져나가는 쪽의 대여소는 그 비율이 더 적고, 그러므로 많이 빠져나갔다. 나타내어진 값은 세제곱근이므로 넓게 분포해있는 '5'들의 값은 125, 그리고 좁은 '-10'이하의 값들은 사실상 1000이 넘는 유출량을 의미한다."),r("br"),r("br"),t._v(" 자치구마다의 유출량이 사실상 대여소에 주는 영향이 미미하다고 볼 수 있으므로, 또 유의미한 클러스터링이 존재하는 것으로 보이므로 대여소 자체의 경향을 파악하는 쪽으로 가닥을 잡아야 하겠다. ")])]),r("send-code",{attrs:{number:"32"}},[t._v(" weather = getAllCsvDask('날씨')"),r("br"),t._v(" for i in range(len(weather)):"),r("br"),t._v("     weather[i].columns = ['지점', '지점명', '일시', '기온', '강수량(mm)','풍속(m/s)','습도(%)', '전운량(10분위)', '현상번호']"),r("br"),t._v(" weather = pd.concat(weather)"),r("br"),t._v(" weather['현상번호'] = weather['현상번호'].fillna(0).astype(int).astype(str)"),r("br"),t._v(" weather.loc[weather['현상번호'].str.len()%2 ==1,'현상번호'] = '0'+weather[weather['현상번호'].str.len()%2 ==1]['현상번호']"),r("br"),t._v(" weatherDict = {'00' : '없음', '01':'비', '02':'비', '03':'비', '04':'비', '05':'눈', '06':'눈', '07':'비', '08':'눈',"),r("br"),t._v("                '09':'눈', '10':'눈', '11':'눈', '12':'비', '13':'우박', '14':'우박', '15':'우박', '16':'안개', '17':'안개',"),r("br"),t._v("               '18':'안개', '19':'안개', '20':'눈', '21':'눈', '22':'눈', '23':'이슬', '24':'이슬', '25':'서리', '26':'서리',"),r("br"),t._v("                '27':'서리', '28':'서리', '29':'서리','30':'서리', '31':'서리', '32':'서리', '33':'기타', '34':'서리',"),r("br"),t._v("               '35':'서리', '36' : '서리', '40':'연무', '41':'연무', '42':'연무', '43':'연무', '44':'연무', '45':'연무', '46':'연무', '47':'연무', '48':'연무',"),r("br"),t._v("                '50' : '기타', '51':'기타', '52' : '기타', '53':'기타', '54' : '기타', '55':'기타', '56' : '기타', '57':'기타', '58' : '기타', '59':'기타',"),r("br"),t._v("                '60':'기타'}"),r("br"),t._v(" weather['현상번호'] = weather['현상번호'].str.extract('([0-9]{2})([0-9]{2})?([0-9]{2})?').replace(weatherDict).apply(lambda x: ', '.join(x.dropna().values.tolist()), axis=1)"),r("br"),t._v(" weather['현상번호'] = weather['현상번호'].replace({'안개, 비, 비':'안개, 비', '안개, 안개, 비' : '안개, 비', '안개, 눈, 눈' : '안개, 눈 ', '눈, 눈, 비': '눈, 비' ,'연무, 연무, 눈': '연무, 눈'})"),r("br"),t._v(" weather['강수량(mm)'].fillna(method='bfill', limit=2, inplace=True)"),r("br"),t._v(" weather['전운량(10분위)'].fillna(method='bfill', limit=2, inplace=True)"),r("br"),t._v(" weather['강수량(mm)'].replace(0.0, 0.1, inplace=True)"),r("br"),t._v(" weather.loc[~(weather['현상번호'].str.contains('눈')) & ~(weather['현상번호'].str.contains('비')),'강수량(mm)'] = 0.0"),r("br"),t._v(" #강수량 관측이 3시간마다 이루어지는 경우가 있으므로 2칸까지 채운다."),r("br"),t._v(" #전운량 또한 같이 처리한다."),r("br"),t._v(" #현상번호가 붙은 경우에는 0,1미만이더라도 올림하여 0,1로하고"),r("br"),t._v(" #결측값(비가 오지않은 경우)을 0.0으로 채운다."),r("br"),r("br"),t._v(" weather['안개'] = weather['현상번호'].str.contains('안개').replace({False:0, True:1})"),r("br"),t._v(" weather['비'] = weather['현상번호'].str.contains('비').replace({False:0, True:1})"),r("br"),t._v(" weather['눈'] = weather['현상번호'].str.contains('눈').replace({False:0, True:1})"),r("br"),t._v(" weather['비 또는 눈'] = 1-(1-weather['비'])*(1-weather['눈'])"),r("br"),t._v(" weather['연무'] = weather['현상번호'].str.contains('연무').replace({False:0, True:1})"),r("br"),t._v(" weather.drop(['지점', '지점명', '현상번호', '비', '눈'], axis=1, inplace=True)"),r("br"),t._v(" weather['일시'] = pd.to_datetime(weather['일시'])"),r("br"),t._v(" weather['년'] = weather['일시'].dt.year"),r("br"),t._v(" weather['월'] = weather['일시'].dt.month"),r("br"),t._v(" weather['일'] = weather['일시'].dt.day"),r("br"),t._v(" weather['시'] = weather['일시'].dt.hour"),r("br"),t._v(" weather['휴일'] = weather['일시'].dt.day_of_week.replace({0: 0,1: 0,2: 0,3: 0,4: 0,5: 1,6: 1 })"),r("br"),t._v(" weather.loc[weather['기온'].isna(), '기온'] = 34.0  #직접 검색해서 넣음"),r("br"),t._v(" weather.loc[weather['강수량(mm)'].isna(), '강수량(mm)'] = 0.1"),r("br"),t._v(" weather['풍속(m/s)'].fillna(0.0, inplace=True)"),r("br"),t._v(" weather.info()"),r("br")]),r("receive-code",[t._v(" <class 'pandas.core.frame.DataFrame'>"),r("br"),t._v(" Int64Index: 30648 entries, 0 to 4343"),r("br"),t._v(" Data columns (total 14 columns):"),r("br"),t._v("  #   Column     Non-Null Count  Dtype        "),r("br"),t._v(" ---  ------     --------------  -----        "),r("br"),t._v("  0   일시         30648 non-null  datetime64[ns]"),r("br"),t._v("  1   기온         30648 non-null  float64      "),r("br"),t._v("  2   강수량(mm)    30648 non-null  float64      "),r("br"),t._v("  3   풍속(m/s)    30648 non-null  float64      "),r("br"),t._v("  4   습도(%)      30648 non-null  float64      "),r("br"),t._v("  5   전운량(10분위)  30648 non-null  float64      "),r("br"),t._v("  6   안개         30648 non-null  int64        "),r("br"),t._v("  7   비 또는 눈     30648 non-null  int64        "),r("br"),t._v("  8   연무         30648 non-null  int64        "),r("br"),t._v("  9   년          30648 non-null  int64        "),r("br"),t._v("  10  월          30648 non-null  int64        "),r("br"),t._v("  11  일          30648 non-null  int64        "),r("br"),t._v("  12  시          30648 non-null  int64        "),r("br"),t._v("  13  휴일         30648 non-null  int64        "),r("br"),t._v(" dtypes: datetime64[ns](1), float64(5), int64(8)"),r("br"),t._v(" memory usage: 3.5 MB"),r("br")]),r("div",{staticClass:"typography-line"},[r("p",[t._v(" 이제 실제 예측을 수행하기 위해 날씨 데이터를 추가했다. 앞에서 본 것처럼 최소한 비가 오는지의 여부는 굉장히 중요한 변수이며 실제로 맞는 예측을 하기 위해서는 포함하지 않을 수 없다. 서리, 황사와 같은 카테고리들을 모두 합쳐 안개 또는 연무로 통합하였으며 결측치들을 이전의 관측치를 근거로 하여 채워 넣었다. ")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-008",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},"138d":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("div",{staticClass:"typography-line"}),r("send-code",{attrs:{number:"22"}},[t._v(" fig = px.pie(new_members.groupby(['성별']).sum(), values='가입수', title=\"성별 가입인원 비율\",names=new_members.groupby(['성별']).sum().index)"),r("br"),t._v(" fig.show() ")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/sex_members.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 단순 성별에 따라 분류를 한 그래프는 다음과 같다. 여성과 남성이 비슷하게 가입한 것을 볼 수 있다. 남자가 여성보다 훨씬 더 많을 것으로(2:1정도) 생각했지만 전혀 아니었다. 알 수 없는 None을 빼면 남성과 여성의 비율은 51.2 : 48.8이었다. 아마 None이 티머니GO와 같은 앱에서 무료이용권 광고를 보고 유입된 인원이 맞다면 None에서는 여성의 비율이 더 높을 것이라는 생각이 들었다. ")])]),r("send-code",{attrs:{number:"23"}},[t._v(" top_labels = ['여자', '남자']"),r("br"),t._v(" colors = ['rgba(164, 163, 204, 0.85)', 'rgba(71, 58, 131, 0.8)']"),r("br"),t._v(" y_data = ['70대이상', '60대', '50대', '40대', '30대', '20대', '10대']"),r("br"),t._v(" x_data = [new_members.groupby(['연령대','성별']).sum().loc[i]['가입수'][:2] for i in y_data]"),r("br"),r("br"),t._v(" fig = HorizontalPortionBar(top_labels, x_data, y_data, colors, '연령별 남녀 비율')"),r("br"),t._v(" fig.show() ")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/age_sex_portion.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 연령별 남녀비율을 비교하면 다음과 같았다. 전반적으로 남성이 여성보다 많으나, 20대에서는 유일하게 여성이 과반수였다. 나이가 들수록 여성의 비율이 떨어지는 경향이 있었다. 그럼에도 앞에서 보았듯이 20대의 비중이 매우 커, 이 초과분만으로 여성 남성 비율을 거의 1대1로 만드는데 일조했다. 성인식이 세대별로 변화하는 과정을 나타내는 그래프로 보아도 어느정도는 맞을 것 같다. ")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-008",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},"2c88":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("div",{staticClass:"typography-line"},[r("h3",[t._v("신규가입자 톺아보기")])]),r("send-code",{attrs:{number:"14"}},[t._v(" new_members = getAllCsv('신규가입자')"),r("br"),t._v(" new_members[0].columns = ['사용자', '연령대', '성별', '가입수']"),r("br"),t._v(" new_members[0].index.name = '가입일자'"),r("br"),t._v(" new_members[1].columns = ['사용자', '성별', '연령대', '가입수']"),r("br"),t._v(" new_members[1].index.name = '가입일자'"),r("br"),t._v(" new_members[2].columns = ['사용자', '성별', '연령대', '가입수']"),r("br"),t._v(" new_members[2].index.name = '가입일자'"),r("br"),t._v(" new_members[3].columns = ['사용자', '연령대', '성별', '가입수']"),r("br"),t._v(" new_members[3].index.name = '가입일자'"),r("br"),t._v(" new_members = pd.concat(new_members)"),r("br"),t._v(" new_members.head()"),r("br"),t._v(" new_members.info() ")]),r("div",{staticClass:"d-flex justify-content-center"},[r("img",{staticClass:"frame",attrs:{src:"http://localhost:8000/static/figures/new_members_before_head.png"}})]),r("receive-code",[t._v(" class 'pandas.core.frame.DataFrame'"),r("br"),t._v(" Index: 28749 entries, 2018-07-20 to 2022-06-30"),r("br"),t._v(" Data columns (total 4 columns):"),r("br"),t._v(" # Column Non-Null Count Dtype "),r("br"),t._v(" --- ------ -------------- ----- "),r("br"),t._v(" 0 사용자 28749 non-null object"),r("br"),t._v(" 1 연령대 28749 non-null object"),r("br"),t._v(" 2 성별 24537 non-null object"),r("br"),t._v(" 3 가입수 28749 non-null int64 "),r("br"),t._v(" dtypes: int64(1), object(3)"),r("br"),t._v(" memory usage: 1.1+ MB"),r("br")]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 신규가입자 데이터는 연단위로 나누어져 csv파일로 저장되어 있기 때문에, 직접 만든 함수를 사용하여 특정 폴더에 있는 파일들을 모두 불러와 데이터프레임으로 합쳤다. 다른 컬럼은 모두 결측값이 없고 성별에 Nan값이 있는 것을 확인할 수 있다. 가입수는 연령별로, 성별로, 가입일별로 집계되어 있다. ")])]),r("send-code",{attrs:{number:"15"}},[t._v(" print('사용자 : ',new_members['사용자'].unique())"),r("br"),t._v(" new_members['사용자'] = new_members['사용자'].replace(\"'회원-내국인'\", '회원-내국인').replace(\"'회원-외국인관광객'\", '회원-외국인관광객')"),r("br"),t._v(" print('사용자 : ',new_members['사용자'].unique())"),r("br"),t._v(" print('연령대 : ',new_members['연령대'].unique())"),r("br"),t._v(" new_members['연령대'] = new_members['연령대'].replace(\"'~10대'\", '10대').replace(\"'20대'\", '20대').replace(\"'30대'\", '30대').replace(\"'40대'\", '40대').replace(\"'50대'\", '50대').replace(\"'60대'\", '60대').replace(\"'70대~'\", '70대이상')"),r("br"),t._v(" print('연령대 : ',new_members['연령대'].unique())"),r("br"),t._v(" print('성별 : ',new_members['성별'].unique())"),r("br"),t._v(" new_members['성별'] = new_members['성별'].replace(\"'F'\", 'F').replace(\"'M'\", 'M').replace(\"''\", np.NaN)"),r("br"),t._v(" print('성별 : ',new_members['성별'].unique())"),r("br"),t._v(" print('가입일자 \"\\'\"의 개수 : ',new_members.index.str.contains(\"'\").sum())"),r("br"),t._v(" print('가입일자 \"\\'\"의 개수 : ',new_members.index.str.contains(\"'\").sum())"),r("br"),t._v(' new_members.index = new_members.index.str.replace("\'", "")'),r("br"),t._v(" print('가입일자 \"\\'\"의 개수 : ',new_members.index.str.contains(\"'\").sum()) ")]),r("receive-code",[t._v(" 사용자 : ['회원-내국인' \"'회원-내국인'\" \"'회원-외국인관광객'\"]"),r("br"),t._v(" 사용자 : ['회원-내국인' '회원-외국인관광객']"),r("br"),t._v(" 연령대 : ['10대' '20대' '30대' '40대' '50대' '60대' '70대이상' '기타' \"'~10대'\" \"'20대'\" \"'30대'\" \"'40대'\" \"'50대'\" \"'60대'\" \"'70대~'\"]"),r("br"),t._v(" 연령대 : ['10대' '20대' '30대' '40대' '50대' '60대' '70대이상' '기타']"),r("br"),t._v(" 성별 : [nan 'F' 'M' \"'F'\" \"'M'\" \"''\"]"),r("br"),t._v(" 성별 : [nan 'F' 'M']"),r("br"),t._v(' 가입일자 "\'"의 개수 : 8095'),r("br"),t._v(' 가입일자 "\'"의 개수 : 8095'),r("br"),t._v(' 가입일자 "\'"의 개수 : 0'),r("br")]),r("div",{staticClass:"typography-line"},[r("p",[t._v("또 각 칼럼에는 여러가지 카테고리가 있고 개중에는 표시방식이 중간에 바뀌어 같은 것을 뜻하면서도, 이름이 다른 카테고리가 존재했다. 전부 바로 잡아주었다. ")])]),r("send-code",{attrs:{number:"16"}},[t._v(" new_members.sort_values('가입수', ascending=False).iloc[10:20] ")]),r("div",{staticClass:"d-flex justify-content-center"},[r("img",{staticClass:"frame",attrs:{src:"http://localhost:8000/static/figures/new_member_sorted_nan.png"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 일간 가입자 상위 10-20위 항목을 확인하였으나, 어떤 점이 도드라진다. 전부, 성별 미기재거나, 연령대가 20대, 70대이상, 기타이다. 상위 300개 항목에서 모두 이렇게 나오는 것을 확인했으며 이는 성별 미기재 인원은 남성, 여성 둘 다 있기 때문인 것으로 보인다. "),r("br"),r("br"),t._v(" 따릉이를 네이버 또는 카카오톡으로 회원가입 시도했을 경우 성별은 필수 기재사항이나 서울형 통합이동서비스 티머니GO를 통해 가입할 때는 확인할 수 없는 데이터로 처리되므로 이로 인한 추이가 아닐까 생각한다. 티머니Go를 확인해보았더니 따릉이 한달 무료이용권을 주고 가입자 데이터는 기록되지 않으므로, 그로인한 데이터 오염으로 생각할 수 있을 것 같다. 다운로드 수는 200만 정도이므로 NaN의 총 개수와 얼추 일치한다."),r("br"),r("br"),t._v(" 결측치를 삭제하는 것은 무리라고 판단하여 'None'이라는 카테고리로 넣었고, 시간적인 변화를 살펴보기 위해 인덱스를 연도, 월, 요일로 분리했다. ")])]),r("send-code",{attrs:{number:"17"}},[t._v(" new_members['성별'].fillna('None', inplace = True)"),r("br"),t._v(" new_members['가입연도'] =new_members.index.str.split('-').str[0]"),r("br"),t._v(" new_members['가입월'] =new_members.index.str.split('-').str[1]"),r("br"),t._v(" new_members['가입요일'] = pd.to_datetime(new_members.index).day_of_week"),r("br")])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-006",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},"2d97":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mx-auto col-md-10 col-lg-9 col-xl-5 d-flex flex-column align-items-center"},[r("div",{ref:"scroll"}),r("card",[r("h5",{staticClass:"title",attrs:{slot:"header"},slot:"header"},[t._v(t._s(t.$t("accont.newPasswordSet")))]),r("ValidationObserver",{ref:"passwordForm"},[r("form",{on:{submit:function(e){return e.preventDefault(),t.passwordFormValidation.apply(null,arguments)}}},[r("ValidationProvider",{attrs:{name:t.$t("accont.new_password"),rules:"required|min:7|max:20|confirmed:confirmation"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{type:"password",required:"",label:t.$t("accont.new_password"),error:o[0]},model:{value:t.passwordForm.password,callback:function(e){t.$set(t.passwordForm,"password",e)},expression:"passwordForm.password"}})]}}])}),r("ValidationProvider",{attrs:{name:t.$t("accont.new_confirmation"),vid:"confirmation",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{type:"password",required:"",label:t.$t("accont.new_confirmation"),error:o[0]},model:{value:t.passwordForm.confirmation,callback:function(e){t.$set(t.passwordForm,"confirmation",e)},expression:"passwordForm.confirmation"}})]}}])}),r("div",{staticClass:"col-12 d-flex justify-content-between"},[r("div"),r("base-button",{staticClass:"btn-fill",attrs:{type:"primary"},on:{click:t.UpdatePasswordForm}},[r("i",{staticClass:"tim-icons icon-pencil",staticStyle:{"font-size":"1.3rem"}}),t._v(" "+t._s(t.$t("accont.submit"))+" ")])],1)],1)])],1)],1)},s=[],o=r("5530"),i=(r("d3b7"),r("2f62")),n=r("3d20"),l=r.n(n),_=r("2ef0"),d=r.n(_),c={components:{},data:function(){return{passwordForm:{password:null,confirmation:null,token:null}}},methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])(["update","logout"])),{},{passwordFormValidation:function(){var t=this;if(this.user_id)return this.$refs.passwordForm.validate().then((function(e){!0===e&&t.UpdatePasswordForm()}))},UpdatePasswordForm:function(){var t=this,e=d.a.cloneDeep(this.passwordForm);this.$normalHttp.post("/api/auth/password_reset/confirm/",e).then((function(e){if(!(e.data.data=1))throw t.$t("swal.changePwFailed");l.a.fire({title:t.$t("swal.success"),text:t.$t("swal.changePwSuccess"),timer:3e3,buttonsStyling:!1,customClass:{confirmButton:"btn btn-success btn-fill"},icon:"success"}),t.$router.push("/")})).catch((function(e){t.$errorHandler(e)}))}}),computed:Object(o["a"])({},Object(i["c"])(["username","image","user_id"])),created:function(){var t=this;this.passwordForm.token=this.$route.query["token"],this.passwordForm.token||l.a.fire({title:this.$t("swal.error"),text:this.$t("swal.badRequest"),timer:2e3,icon:"warning",confirmButtonClass:"btn btn-waring btn-fill",buttonsStyling:!1}).finally((function(){t.$router.push("/")}))}},b=c,v=(r("7937"),r("2877")),u=Object(v["a"])(b,a,s,!1,null,null,null);e["default"]=u.exports},"32e1":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("send-code",{attrs:{number:"11"}},[t._v(" spot_per_pop = pd.merge(left = pd.DataFrame(spot_district), right = district[['지역','인구']], how='left', left_on = '자치구', right_on='지역').set_index('지역')"),r("br"),t._v(" tmp = spot_per_pop['대여소']"),r("br"),t._v(" spot_per_pop['대여소'] = spot_per_pop['대여소']/spot_per_pop.max(axis=0)['대여소']"),r("br"),t._v(" spot_per_pop['인구'] = spot_per_pop['인구']/spot_per_pop.max(axis=0)['인구']"),r("br"),t._v(" fig = dfPlot(spot_per_pop, spot_per_pop.index, ['대여소', '인구'], title='자치구별 인구&대여소 비율', orderArray=spot_per_pop.sort_values('인구', ascending = False).index)"),r("br"),t._v(" fig.show() ")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/spot_per_pop2.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v("따라서 면적대비 비교는 별로 의미가 없고, 인구수 대비 비교가 차라리 나을 것이다. 송파구에서의 인구수 대비 대여소 비율을 1이라고 가정했을 때, 각 자치구의 비율은 어떻게 되는지 확인해보았다. 다른 구는 그 비율이 모두 1.2가 되지 않지만 종로구와 중구는 그것의 거의 두배가 될 정도로 높다."),r("br"),r("br"),t._v(" 종로구와 중구가 높은 이유는 일일 통행인구 비율이 높기 때문인 것 같다. 지금까지 데이터로는 그 사실을 캐치하기 힘들었기 때문에 이런 차이가 반영되지 않은 것으로 생각된다. 서울 내부의 생활이동을 파악하는 것은 또 다른 데이터분석 주제가 될 정도로 큰 것이지만 우선은 서울시에서 제공하는 "),r("a",{attrs:{href:"https://data.seoul.go.kr/livPopu/html/dashboard.html",target:"_blank"}},[t._v("https://data.seoul.go.kr/livPopu/html/dashboard.html")]),t._v(" 에서 . 22년 4월 1달간 생활이동인구의 데이터만 가지고 그 개요만 살펴보았다.")])]),r("send-code",{attrs:{number:"12"}},[t._v(" live_Pop = pd.read_csv(data_dir+'자치구/22년4월생활이동인구.csv', encoding='cp949', index_col=0)"),r("br"),t._v(" spot_district = live_Pop.merge(spot_district,left_index=True, right_index=True)"),r("br"),t._v(" spot_district['총이동인구'] = spot_district['유입']+spot_district['유출']"),r("br"),t._v(" spot_district.drop(['유입', '유출'], axis=1, inplace = True)"),r("br"),t._v(" spot_district['대여소'] = spot_district['대여소']/spot_district.max(axis=0)['대여소']"),r("br"),t._v(" spot_district['총이동인구'] = spot_district['총이동인구']/spot_district.max(axis=0)['총이동인구']"),r("br"),t._v(" spot_district['대여소/이동인구 비율'] = (spot_district['대여소']/spot_district['총이동인구']).round(3)"),r("br"),t._v(" spot_district = spot_district['대여소/이동인구 비율']"),r("br"),t._v(" spot_district.name = '대여소/이동인구'"),r("br"),t._v(" fig = seriesPlot(spot_district, title=\"자치구별 이동인구 대비 대여소 비율\", order = 'total descending', color=True, colorScale = px.colors.sequential.Sunsetdark)"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/spot_per_live_pop.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v("아직 최고치와 최저치가 2배정도 차이나지만 그래도 지금까지 본것에 비해면 꽤나 온건한 그래프가 나왔다. 그래프를 보면, 중구, 강남구는 인구수 대비 많은 수가 설치되었으나, 이동인구에 비하면 그것마저도 아직 부족한 상황인 것을 알 수 있다. 이동인구의 수가 많아도 그 이동인구의 연령대별 비율에 따른 차이가 있을 수 있다는 생각이 들었지만, 그것은 자전거 대여비율로 살펴보도록 하고, 여기서 다루지는 않겠다."),r("br"),r("br"),t._v(" 우선은 자치구마다 대여소의 개수들을 나타낸 데이터프레임을 저장했다. ")])]),r("send-code",{attrs:{number:"13"}},[t._v(" spot_district = pd.DataFrame(share_spot.groupby('자치구').size())"),r("br"),t._v(" district = pd.merge(left=district, right=spot_district, left_on = '지역', right_on = spot_district.index)"),r("br"),t._v(" district.columns = ['지역', '인구', '면적', '인구밀도(명/㎢)', '대여소'] ")])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-005",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},"4dfc":function(t,e,r){},"4fad":function(t,e,r){var a=r("d039"),s=r("861d"),o=r("c6b6"),i=r("d86b"),n=Object.isExtensible,l=a((function(){n(1)}));t.exports=l||i?function(t){return!!s(t)&&((!i||"ArrayBuffer"!=o(t))&&(!n||n(t)))}:n},"54b7":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mx-auto col-md-10 col-lg-9 col-xl-5 d-flex flex-column align-items-center"},[r("div",{ref:"scroll"}),r("card",{staticClass:"card-user"},[r("p",{staticClass:"card-text"}),r("div",{staticClass:"author"},[r("div",{staticClass:"block block-one"}),r("div",{staticClass:"block block-two"}),r("div",{staticClass:"block block-three"}),r("div",{staticClass:"block block-four"}),r("a",{attrs:{href:"javascript:void(0)"}},[r("img",{staticClass:"avatar",attrs:{src:t.image,alt:"userImage"}}),r("h5",{staticClass:"title"},[t._v(t._s(t.username))])]),r("div",{staticClass:"card-description"},[r("h5",[t._v(t._s(t.$t("mypage.welcome")))]),t.sinceDay<2?r("small",[t._v(t._s(t.$t("mypage.signupToday")))]):r("small",[t._v(t._s(t.$t("mypage.signupDay"))+" "+t._s(t.sinceDay)+t._s(t.$t("mypage.signupDay2")))])])])]),r("card",[r("h5",{staticClass:"title",attrs:{slot:"header"},slot:"header"},[t._v(t._s(t.$t("mypage.EditProfile")))]),r("ValidationObserver",{ref:"form"},[r("form",{on:{submit:function(e){return e.preventDefault(),t.formValidation.apply(null,arguments)}}},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-7"},[r("div",[r("base-input",{attrs:{type:"text",label:t.$t("accont.username"),disabled:!0},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),r("div",[r("ValidationProvider",{attrs:{name:t.$t("accont.password"),rules:"required|min:7|max:20|confirmed:confirmation"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{type:"password",required:"",label:t.$t("accont.password"),error:o[0]},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})]}}])})],1),r("div",[r("ValidationProvider",{attrs:{name:t.$t("accont.confirmation"),vid:"confirmation",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{type:"password",required:"",label:t.$t("accont.confirmation"),error:o[0]},model:{value:t.form.confirmation,callback:function(e){t.$set(t.form,"confirmation",e)},expression:"form.confirmation"}})]}}])})],1)]),r("div",{staticClass:"col-5 m-auto"},[r("image-upload",{staticClass:"imgupload",attrs:{type:"avatar","select-text":"Change photo"},on:{change:t.onImageChange}})],1)]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-6"},[r("ValidationProvider",{attrs:{name:t.$t("accont.lastName"),rules:"required|min:1|max:20|korAlpha"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{type:"text",required:"",label:t.$t("accont.lastName"),error:o[0]},model:{value:t.form.last_name,callback:function(e){t.$set(t.form,"last_name",e)},expression:"form.last_name"}})]}}])})],1),r("div",{staticClass:"col-md-6"},[r("ValidationProvider",{attrs:{name:t.$t("accont.firstName"),rules:"required|min:1|max:50|korAlpha"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{type:"text",required:"",label:t.$t("accont.firstName"),error:o[0]},model:{value:t.form.first_name,callback:function(e){t.$set(t.form,"first_name",e)},expression:"form.first_name"}})]}}])})],1)]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-12"},[r("ValidationProvider",{attrs:{name:t.$t("accont.email"),rules:"email"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{type:"email",label:t.$t("accont.email"),error:o[0]},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})]}}])})],1)]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-12"},[r("ValidationProvider",{attrs:{name:t.$t("accont.user_spots"),rules:"spots"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{type:"text",label:t.$t("accont.user_spots"),error:o[0]},on:{focus:t.modalFunc},model:{value:t.form.user_spots,callback:function(e){t.$set(t.form,"user_spots",e)},expression:"form.user_spots"}})]}}])})],1)]),r("div",{staticClass:"row col-12 d-flex justify-content-between"},[r("base-button",{staticClass:"btn-fill",attrs:{type:"primary"},on:{click:function(e){return t.PasswordChangeButton(!0)}}},[r("i",{staticClass:"tim-icons icon-cloud-upload-94",staticStyle:{"font-size":"1.3rem"}}),t._v(" "+t._s(t.$t("mypage.changePw"))+" ")]),r("base-button",{staticClass:"btn-fill",attrs:{"native-type":"submit",type:"primary"}},[r("i",{staticClass:"tim-icons icon-badge",staticStyle:{"font-size":"1.3rem"}}),t._v(" "+t._s(t.$t("mypage.changeInfo"))+" ")])],1)])])],1),r("div",{staticClass:"row col-12 d-flex justify-content-between"},[r("base-button",{directives:[{name:"show",rawName:"v-show",value:!t.passwordPageShow,expression:"!passwordPageShow"}],staticClass:"btn-fill",attrs:{type:"warning"},on:{click:t.BackRoute}},[r("i",{staticClass:"tim-icons icon-refresh-01",staticStyle:{"font-size":"1.3rem"}}),t._v(" "+t._s(t.$t("mypage.goBack"))+" ")]),r("base-button",{directives:[{name:"show",rawName:"v-show",value:!t.passwordPageShow,expression:"!passwordPageShow"}],staticClass:"btn-fill",attrs:{type:"danger"},on:{click:t.DeleteUserButton}},[r("i",{staticClass:"tim-icons icon-trash-simple",staticStyle:{"font-size":"1.3rem"}}),t._v(" "+t._s(t.$t("mypage.withdrawal"))+" ")])],1),r("transition",{attrs:{name:"fade"}},[r("card",{directives:[{name:"show",rawName:"v-show",value:t.passwordPageShow,expression:"passwordPageShow"}]},[r("h5",{staticClass:"title",attrs:{slot:"header"},slot:"header"},[t._v(t._s(t.$t("mypage.changePw")))]),r("ValidationObserver",{ref:"passwordForm"},[r("form",{on:{submit:function(e){return e.preventDefault(),t.passwordFormValidation.apply(null,arguments)}}},[r("ValidationProvider",{attrs:{name:t.$t("accont.password"),rules:"required|min:7|max:20"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{type:"password",required:"",label:t.$t("accont.password"),error:o[0]},model:{value:t.passwordForm.password,callback:function(e){t.$set(t.passwordForm,"password",e)},expression:"passwordForm.password"}})]}}])}),r("ValidationProvider",{attrs:{name:t.$t("accont.new_password"),rules:"required|min:7|max:20|confirmed:confirmation"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{type:"password",required:"",label:t.$t("accont.new_password"),error:o[0]},model:{value:t.passwordForm.new_password,callback:function(e){t.$set(t.passwordForm,"new_password",e)},expression:"passwordForm.new_password"}})]}}])}),r("ValidationProvider",{attrs:{name:t.$t("accont.new_confirmation"),vid:"confirmation",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{type:"password",required:"",label:t.$t("accont.new_confirmation"),error:o[0]},model:{value:t.passwordForm.new_confirmation,callback:function(e){t.$set(t.passwordForm,"new_confirmation",e)},expression:"passwordForm.new_confirmation"}})]}}])}),r("div",{staticClass:"col-12 d-flex justify-content-between"},[r("base-button",{staticClass:"btn-fill",attrs:{type:"primary"},on:{click:function(e){return t.PasswordChangeButton(!1)}}},[r("i",{staticClass:"tim-icons icon-minimal-up",staticStyle:{"font-size":"1.3rem"}}),t._v(" "+t._s(t.$t("mypage.cancel"))+" ")]),r("base-button",{staticClass:"btn-fill",attrs:{"native-type":"submit",type:"primary"}},[r("i",{staticClass:"tim-icons icon-pencil",staticStyle:{"font-size":"1.3rem"}}),t._v(" "+t._s(t.$t("mypage.changePw"))+" ")])],1)],1)])],1)],1),r("modal",{attrs:{show:t.modalShow,headerClasses:"justify-content-center",showClose:!1},on:{"update:show":function(e){t.modalShow=e}}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("h4",{staticClass:"title title-up"},[t._v(t._s(t.$t("accont.bikespotselect")))])]),r("p",{staticClass:"description"},[t._v(t._s(t.$t("accont.bikespotselectExplanation")))]),t.modalShow?r("spot-map",{attrs:{mode:"multiple",selectedBikespot:t.newSelectedBikespot},on:{bikeSpots:t.bikeSpots}}):t._e(),r("p",{staticClass:"description p-3 pt-3"},[r("strong",[t._v(t._s(this.selectedBikespotString))])]),r("template",{slot:"footer"},[r("div",[r("base-button",{staticClass:"my-3",attrs:{type:"danger"},on:{click:t.DeleteSpot}},[t._v(t._s(t.$t("accont.deleteAll")))]),r("base-button",{staticClass:"my-3 mx-3",attrs:{type:"danger"},on:{click:t.CancelSpot}},[t._v(t._s(t.$t("accont.cancel")))])],1),r("base-button",{staticClass:"m-3",on:{click:t.Okayspot}},[t._v(t._s(t.$t("accont.confirm"))+" ")])],1)],2),r("modal",{staticClass:"deleteModal",attrs:{show:t.deleteModalShow,centered:!0},on:{"update:show":function(e){t.deleteModalShow=e}}},[r("ValidationObserver",{ref:"deleteForm"},[r("form",{on:{submit:function(e){return e.preventDefault(),t.deleteFormValidation.apply(null,arguments)}}},[r("ValidationProvider",{attrs:{name:t.$t("accont.password"),rules:"required|min:7|max:20|confirmed:confirmation"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{type:"password",required:"",label:t.$t("accont.password"),error:o[0]},model:{value:t.deleteForm.password,callback:function(e){t.$set(t.deleteForm,"password",e)},expression:"deleteForm.password"}})]}}])}),r("ValidationProvider",{attrs:{name:t.$t("accont.confirmation"),vid:"confirmation",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{type:"password",required:"",label:t.$t("accont.confirmation"),error:o[0]},model:{value:t.deleteForm.confirmation,callback:function(e){t.$set(t.deleteForm,"confirmation",e)},expression:"deleteForm.confirmation"}})]}}])}),r("div",{staticClass:"col-12 py-4 d-flex justify-content-between"},[r("base-button",{staticClass:"btn-fill",attrs:{type:"success"},on:{click:function(e){t.deleteModalShow=!1}}},[r("i",{staticClass:"tim-icons icon-satisfied",staticStyle:{"font-size":"1.3rem"}}),t._v(" "+t._s(t.$t("mypage.changeMind"))+" ")]),r("base-button",{staticClass:"btn-fill",attrs:{"native-type":"submit",type:"danger"}},[r("i",{staticClass:"tim-icons icon-user-run",staticStyle:{"font-size":"1.3rem"}}),t._v(" "+t._s(t.$t("mypage.delete"))+" ")])],1)],1)])],1)],1)},s=[];r("fb6a"),r("dca8");function o(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var i,n=r("5530"),l=(r("ac1f"),r("00b4"),r("d3b7"),r("a15b"),r("d81d"),r("2f62")),_=r("7bb1"),d=r("2af9"),c=r("63e4"),b=r("3d20"),v=r.n(b),u=r("2ef0"),p=r.n(u);Object(_["extend"])("korAlphaNum",{validate:function(t){var e=/^[가-힣|aA-zZ|0-9]*$/.test(t);return!!e||this.$t("validation.korAlphaNum")}}),Object(_["extend"])("korAlpha",{validate:function(t){var e=/^[가-힣|aA-zZ]*$/.test(t);return!!e||this.$t("validation.korAlpha")}}),Object(_["extend"])("spots",{validate:function(t){var e=/^[0-9 \,]*$/.test(t);return!!e||this.$t("validation.spots")}});var m={components:{ImageUpload:d["i"],Modal:d["k"],SpotMap:c["a"]},data:function(){return{form:{username:null,email:null,password:null,confirmation:null,first_name:null,last_name:null,user_spots:null,image:null},passwordForm:{password:null,new_password:null,new_confirmation:null},deleteForm:{password:null,confirmation:null},date_joined:null,selectedBikespot:[],newSelectedBikespot:[],modalShow:!1,ImageChange:!1,passwordPageShow:!1,deleteModalShow:!1}},methods:Object(n["a"])(Object(n["a"])({},Object(l["b"])(["update","logout"])),{},{formValidation:function(){var t=this;if(this.user_id)return this.$refs.form.validate().then((function(e){!0===e&&t.UpdateForm()}))},passwordFormValidation:function(){var t=this;if(this.user_id)return this.$refs.passwordForm.validate().then((function(e){!0===e&&t.UpdatePasswordForm()}))},deleteFormValidation:function(){var t=this;if(this.user_id)return this.$refs.deleteForm.validate().then((function(e){!0===e&&t.UserDeleteForm()}))},UpdateForm:function(){var t=this;console.log(this.form);var e,r=p.a.cloneDeep(this.form);this.ImageChange?e={"Content-Type":"multipart/form-data"}:(delete r.image,e={"Content-Type":"application/json"}),this.$authHttp.patch("/api/seoulbike/user/".concat(this.user_id,"/"),r,{headers:e}).then((function(e){var r=e.data;r.user_id=e.data.id,t.update({data:r}),v.a.fire({title:t.$t("")(i||(i=o(["성공!"]))),text:"유저 정보가 성공적으로 변경되었습니다.",timer:3e3,buttonsStyling:!1,customClass:{confirmButton:"btn btn-success btn-fill"},icon:"success"}).then((function(){t.$router.push("/")}))})).catch((function(e){t.$errorHandler(e)}))},UpdatePasswordForm:function(){var t=this,e=p.a.cloneDeep(this.passwordForm);this.$authHttp.put("/api/seoulbike/user/".concat(this.user_id,"/change_pw/"),e).then((function(e){if(!(e.data.data=1))throw t.$t("swal.changePwFailed");v.a.fire({title:t.$t("swal.success"),text:t.$t("swal.changePwSuccess"),timer:3e3,buttonsStyling:!1,customClass:{confirmButton:"btn btn-success btn-fill"},icon:"success"}),t.passwordForm.password="",t.passwordForm.new_password="",t.passwordForm.new_confirmation="",t.passwordPageShow=!1})).catch((function(e){t.$errorHandler(e)}))},UserDeleteForm:function(){var t=this,e=p.a.cloneDeep(this.deleteForm);this.$authHttp.delete("/api/seoulbike/user/".concat(this.user_id,"/"),{data:e}).then((function(e){v.a.fire({title:t.$t("swal.deleted"),text:t.$t("swal.deletedSuccessfully"),timer:3e3,buttonsStyling:!1,customClass:{confirmButton:"btn btn-login btn-fill"}}).then((function(){t.logout({user_id:void 0})})).finally((function(){t.$router.push("/")}))})).catch((function(t){console.log(t)}))},onImageChange:function(t){this.form.image=t,this.ImageChange=!0},bikeSpots:function(t){this.newSelectedBikespot=t},DeleteSpot:function(){this.newSelectedBikespot=[],this.selectedBikespot=[],this.form.user_spots="",this.modalShow=!1},CancelSpot:function(){this.modalShow=!1,this.newSelectedBikespot=this.selectedBikespot.slice()},Okayspot:function(){this.selectedBikespot=this.newSelectedBikespot.slice(),this.form.user_spots=this.selectedBikespot.join(", "),this.modalShow=!1},modalFunc:function(){this.modalShow=!0},BackRoute:function(){var t=this;v.a.fire({title:this.$t("swal.goBack"),text:this.$t("swal.goBackConfirm"),showCancelButton:!0,customClass:{confirmButton:"btn btn-info btn-fill",cancelButton:"btn btn-danger btn-fill"},confirmButtonText:this.$t("swal.goBack"),cancelButtonText:this.$t("swal.cancel"),buttonsStyling:!1}).then((function(e){e.value&&t.$router.back()}))},PasswordChangeButton:function(t){this.passwordPageShow=t},DeleteUserButton:function(){var t=this;this.user_id&&v.a.fire({title:this.$t("swal.withdrawal"),text:this.$t("swal.withdrawalConfirm"),icon:"warning",showCancelButton:!0,customClass:{confirmButton:"btn btn-success btn-fill",cancelButton:"btn btn-danger btn-fill"},confirmButtonText:this.$t("swal.yes"),cancelButtonText:this.$t("swal.noIwillGoBack"),buttonsStyling:!1}).then((function(e){e.value&&(t.deleteModalShow=!0)}))}}),computed:Object(n["a"])(Object(n["a"])({},Object(l["c"])(["username","image","user_id"])),{},{selectedBikespotString:function(){return this.newSelectedBikespot.map((function(t){return t+"번"})).join(", ")},sinceDay:function(){return Math.ceil((Date.now()-Date.parse(this.date_joined))/1e3/60/60/24)}}),mounted:function(){var t=this;this.$refs.scroll.scrollIntoView(),this.$authHttp.get("/api/seoulbike/user/".concat(this.user_id,"/")).then((function(e){t.form.username=e.data.username,t.form.first_name=e.data.first_name,t.form.last_name=e.data.last_name,t.form.image=e.data.image,t.form.id=e.data.id,t.form.email=e.data.email,t.form.user_spots=e.data.user_spots.join(", "),t.date_joined=e.data.date_joined,t.selectedBikespot=e.data.user_spots,t.newSelectedBikespot=e.data.user_spots,t.$el.querySelector(".imgupload img")["src"]=e.data.image})).catch((function(t){}))}},f=m,h=(r("f464"),r("2877")),g=Object(h["a"])(f,a,s,!1,null,null,null);e["default"]=g.exports},"65c2":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("send-code",{attrs:{number:"4"}},[t._v(" age_sex_use_portion = daily_use.groupby(['연령대', '성별코드']).sum()"),r("br"),t._v(" y_data = ['기타', '70대이상', '60대', '50대', '40대', '30대', '20대', '10대','10대미만']"),r("br"),t._v(" x_data = [age_sex_use_portion.loc[i].loc['F':'M', '이용건수'] for i in y_data]"),r("br"),t._v(" top_labels = ['여성', '남성']"),r("br"),t._v(" fig = HorizontalPortionBar(top_labels, x_data, y_data, title='연령별 남녀 이용률')"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/age_sex_use_portion.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v("연령별 남녀 이용률을 살펴보면, 20대에서는 거의 남녀가 비슷했으며 그 이외의 구간에서는 남성의 이용비율이 60퍼센트를 상회했다. 60대에서는 거의 1:4까지 떨어졌다. 가입인원 비율과 이용비율이 차이나는 것은 유령회원의 비중이 높을 수 있다는 것을 뜻하기도 하고, 또 그 반대쪽에서 충성회원의 비중이 높을 수 있다는 것을 의미하기도 한다. ")])]),r("send-code",{attrs:{number:"5"}},[t._v(" age_sex_use_portion['평균 이용시간(분)'] = age_sex_use_portion['이용시간(분)'] / age_sex_use_portion['이용건수']"),r("br"),t._v(" age_sex_use_portion['평균 이동거리(m)'] = age_sex_use_portion['이동거리(m)'] / age_sex_use_portion['이용건수']"),r("br"),t._v(" age_sex_usetime = age_sex_use_portion[age_sex_use_portion.index.get_level_values(1)!='None']"),r("br"),t._v(" age_sex_usetime = age_sex_usetime.loc[['10대미만', '10대', '20대', '30대', '40대', '50대', '60대','70대이상', '기타']]"),r("br"),r("br"),t._v(' fig = px.histogram(age_sex_usetime, x=age_sex_usetime.index.get_level_values(0), y="평균 이용시간(분)",'),r("br"),t._v(" color=age_sex_usetime.index.get_level_values(1), barmode='group', histfunc='avg', title='연령대별 평균 이용시간',labels={\"평균 이용시간(분)\":\"이용시간(분)\" ,'x': '연령대'}, height=400)"),r("br"),t._v(" fig.show()"),r("br"),r("br"),t._v(' fig = px.histogram(age_sex_usetime, x=age_sex_usetime.index.get_level_values(0), y="평균 이동거리(m)",'),r("br"),t._v(" color=age_sex_usetime.index.get_level_values(1), barmode='group',histfunc='avg', title='연령대별 평균 이동거리',labels={\"평균 이동거리(m)\":\"이동거리(m)\" ,'x': '연령대'}, height=400)"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"row"},[r("object",{staticClass:"col-6",attrs:{data:"http://localhost:8000/static/figures/age_sex_usetime.html",height:"450",type:"text/html"}}),r("object",{staticClass:"col-6",attrs:{data:"http://localhost:8000/static/figures/age_sex_usedist.html",height:"450",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 왼쪽 그래프는 연령대와 성별에 따른 평균 이용시간을 비교한 것이고, 오른쪽은 평균 이동거리를 비교한 것이다. 여성이 모든 연령대에서 대체적으로 남성보다 오래타고, 멀리타는 것을 알 수 있다. 이는 위에서 살펴본 남녀 이용비율의 차이와 조합해 봤을 때, 하나의 가설을 만들 수 있다."),r("br"),r("br"),r("strong",[t._v("여성은 여가의 목적으로(빠르지 않고, 느긋하게, 간헐적으로) 이용하는 비중이 높고, "),r("br"),t._v("남성은 이동의 목적으로(빠르고, 더 자주) 이용하는 비중이 높다 ")]),r("br"),r("br"),t._v(" 아마도 이 가설의 뿌리는 필자가 이동의 목적으로 따릉이를 이용한다는 점에서 시작되었을 것이다. 그러나 충분히 가능성 있는 접근이라고 생각한다. ")])]),r("send-code",{attrs:{number:"6"}},[t._v(" daily_use['대여일자'] = pd.to_datetime(daily_use['대여일자'])"),r("br"),t._v(" daily_use['연'] = daily_use['대여일자'].dt.year"),r("br"),t._v(" daily_use['월'] = daily_use['대여일자'].dt.month"),r("br"),t._v(" daily_use['일'] = daily_use['대여일자'].dt.day"),r("br"),t._v(" daily_use['대여요일'] = daily_use['대여일자'].dt.dayofweek"),r("br"),t._v(" daily_use['대여요일'] = daily_use.loc[:,'대여요일'].replace({0:'월', 1:'화', 2:\"수\", 3:'목', 4:'금', 5:'토', 6:'일'})"),r("br"),r("br"),t._v(" use_type_portion =daily_use.groupby(['대여구분코드']).size()"),r("br"),t._v(" use_type_portion.name = '인원수'"),r("br"),t._v(" fig = px.pie(use_type_portion, values='인원수',title=\"대여종류 비율\", names=use_type_portion.index, color_discrete_sequence=px.colors.sequential.Sunset)"),r("br"),t._v(" fig.show() ")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/use_type_portion.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 전체 이용횟수에서 정기권 이용자가 거의 대부분을 차지했고, 그 다음은 일일권이었다. 비회원과 단체는 각각 1퍼센트 내외였다. 정기권 이용자가 정기적으로 이용하는 그 양상을 파악하는 것이 최우선 목표가 될 것이다. ")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-001",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},"678f":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("send-code",{attrs:{number:"9"}},[t._v(" share_spot_district_year = share_spot.groupby(['연','자치구']).size().reset_index().pivot(index='연', columns='자치구', values=0).fillna(0).cumsum()"),r("br"),t._v(" fig = pivotToTimeplot(share_spot_district_year, title='자치구별 대여소 현황', yaxis = '대여소 개수', yRange=[0, 220], order = True)"),r("br"),t._v(" fig.show() ")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/share_spot_district_year.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v("따릉이는 2016년까지는 마포구 등, 특정 자치구에 시범설치 후에 2017년부터 본격적으로 운영이 시작되었다. 2020년에도 많은 수가 설치되었는데 송파구, 강서구, 강남구 등등 소위 '잘 사는' 동네가 더 많은 대여소를 가지고 있다. 송파구의 경우에는 지도에서는 그렇게 밀도가 높아보이지 않았는데, 이는 송파구가 넓은 구이기 때문인 것이라고 생각된다.")])]),r("send-code",{attrs:{number:"10"}},[t._v(" district = pd.read_table(data_dir+'자치구/인구밀도.txt', sep='\\t')"),r("br"),t._v(" district['인구'] = district['인구'].str.replace(',','').astype(float).astype(int) #쉼표를 제거"),r("br"),t._v(" district['인구밀도(명/㎢)'] = district['인구밀도(명/㎢)'].str.replace(',','').astype(float).astype(int)"),r("br"),t._v(" district.drop('기간', axis=1, inplace=True)"),r("br"),r("br"),t._v(" spot_district = share_spot.groupby('자치구').size()"),r("br"),t._v(" spot_district.name = '대여소'"),r("br"),t._v(" spot_per_space = pd.merge(left = pd.DataFrame(spot_district), right = district[['지역','면적']], how='left', left_on = '자치구', right_on='지역').set_index('지역')"),r("br"),r("br"),t._v(" spot_per_space['대여소'] = spot_per_space['대여소']/spot_per_space.max(axis=0)['대여소']"),r("br"),t._v(" spot_per_space['면적'] = spot_per_space['면적']/spot_per_space.max(axis=0)['면적']"),r("br"),t._v(" fig = dfPlot(spot_per_space, spot_per_space.index, ['대여소', '면적'], title='자치구별 면적&대여소 비율', orderArray=spot_per_space.sort_values('면적', ascending = False).index)"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/spot_per_space.html",width:"800",height:"400",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v("지역구별 인구와 면적 데이터는 인터넷에서 쉽게 구할 수 있다. 조금만 다듬으면 이미 지역구별 대여소 개수를 알고 있으므로 면적 당 대여소의 개수를 구할 수 있다. 다만 여기서는 대여소 수와 면적은 scale이 맞지 않으므로 최대값을 1로 정규화했다."),r("br"),t._v(" 결과적으로 강서구, 강남구, 송파구에 많은 대여소가 배치된 것은 절대적으로 큰 면적을 가지고있기 때문인 것으로 판명났다. 면적당 개수로는 그렇게 도드라지는 면이 없었다. 다만 중구의 면적대비 대여소 개수는 꽤나 높아 보인다. 중구에는 대여소가 많이 설치되어 있지 않지만 그 크기가 매우 작으므로 사실은 매우 촘촘히 설치되어 있는 것이다. ")])]),r("div",{staticClass:"row"},[r("img",{staticClass:"col-6",attrs:{src:"http://localhost:8000/static/figures/S-Map-중구.png"}}),r("img",{staticClass:"col-6",attrs:{src:"http://localhost:8000/static/figures/S-Map-관악구.png"}})]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-6"},[r("p",[r("i",{staticClass:"tim-icons icon-minimal-up"}),t._v("중구")])]),r("div",{staticClass:"col-6"},[r("p",[r("i",{staticClass:"tim-icons icon-minimal-up"}),t._v("관악구")])])]),r("div",{staticClass:"typography-line"},[r("p",[t._v("관악구 신림동에서 잠시 지냈던 적이 있는데 지금 생각해보면 따릉이를 거의 본적이 없던 것 같다. 또 언덕이 너무 많고 높아서 따릉이를 타봤자 어짜피 끌고 가야할 지도 모른다. 이 점에 착안해 서울시에서 제공하는 S-map 해발고도 히트맵을 확인해 보았다."),r("br"),r("br"),t._v(" 그랬더니 확실하게 차이가 보였다. 알고보니 중구는 서울에서 유일하게 99.9% 면적이 생활이용되고 있는 구였다. 다른 구들은 하천, 산 등 때문에 그렇게 하고 있지 못하다. ")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-004",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},7479:function(t,e,r){"use strict";r("e41c")},7937:function(t,e,r){"use strict";r("922b")},"898d":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("send-code",{attrs:{number:"22"}},[t._v(" time_split_2021 = log_data2021.copy()"),r("br"),r("br"),t._v(" time_split_2021['대여월'] = time_split_2021['대여일시'].dt.month"),r("br"),t._v(" time_split_2021['대여요일'] = time_split_2021['대여일시'].dt.day_of_week"),r("br"),t._v(" time_split_2021['대여일'] = time_split_2021['대여일시'].dt.day"),r("br"),t._v(" time_split_2021['대여시'] = time_split_2021['대여일시'].dt.hour"),r("br"),t._v(" time_split_2021['반납월'] = time_split_2021['반납일시'].dt.month"),r("br"),t._v(" time_split_2021['반납요일'] = time_split_2021['반납일시'].dt.day_of_week"),r("br"),t._v(" time_split_2021['반납일'] = time_split_2021['반납일시'].dt.day"),r("br"),t._v(" time_split_2021['반납시'] = time_split_2021['반납일시'].dt.hour"),r("br"),t._v(" time_split_2021.drop(['자전거번호', '대여일시', '반납일시'], axis=1, inplace=True)"),r("br"),t._v(" time_split_2021 = pd.merge(left=time_split_2021, right=share_spot.loc[:,['대여소번호','자치구']], left_on='대여대여소번호', right_on = '대여소번호')"),r("br"),t._v(" time_split_2021.drop('대여소번호', axis=1, inplace=True)"),r("br"),t._v(" time_split_2021.columns = ['대여대여소번호', '반납대여소번호', '이용시간', '이용거리', '대여월',"),r("br"),t._v("        '대여요일', '대여일', '대여시', '반납월', '반납요일', '반납일', '반납시', '대여자치구']"),r("br"),t._v(" time_split_2021 = pd.merge(left=time_split_2021, right=share_spot.loc[:,['대여소번호','자치구']], left_on='반납대여소번호', right_on = '대여소번호')"),r("br"),t._v(" time_split_2021.drop('대여소번호', axis=1, inplace=True)"),r("br"),t._v(" time_split_2021.columns = ['대여대여소번호', '반납대여소번호', '이용시간', '이용거리', '대여월',"),r("br"),t._v("        '대여요일', '대여일', '대여시', '반납월', '반납요일', '반납일', '반납시', '대여자치구', '반납자치구']"),r("br"),r("br"),t._v(" hour_2021_대여 = time_split_2021.copy()"),r("br"),t._v(" hour_2021_반납 = time_split_2021.copy()"),r("br"),r("br"),t._v(" hour_2021_대여['이용횟수'] = 1"),r("br"),t._v(" hour_2021_대여 = hour_2021_대여.loc[:,['대여요일', '대여시', '대여자치구', '이용시간', '이용거리', '대여월','이용횟수']].groupby(['대여월','대여요일', '대여시', '대여자치구']).sum()"),r("br"),t._v(" hour_2021_대여 = hour_2021_대여.reset_index()"),r("br"),t._v(" hour_2021_대여 = pd.merge(left = hour_2021_대여, right = district.loc[:,['지역','대여소']], left_on = '대여자치구', right_on = '지역').drop('지역', axis=1)"),r("br"),t._v(" hour_2021_대여['이용시간'] = hour_2021_대여['이용시간']/hour_2021_대여['대여소']"),r("br"),t._v(" hour_2021_대여['이용거리'] = hour_2021_대여['이용거리']/hour_2021_대여['대여소']"),r("br"),t._v(" hour_2021_대여['이용횟수'] = hour_2021_대여['이용횟수']/hour_2021_대여['대여소']"),r("br"),t._v(" hour_2021_대여['상태'] = '대여'"),r("br"),t._v(" hour_2021_반납['이용횟수'] = 1"),r("br"),t._v(" hour_2021_반납 = hour_2021_반납.loc[:,['반납요일', '반납시', '반납자치구', '이용시간', '이용거리', '반납월','이용횟수']].groupby(['반납월','반납요일', '반납시', '반납자치구']).sum()"),r("br"),t._v(" hour_2021_반납 = hour_2021_반납.reset_index()"),r("br"),t._v(" hour_2021_반납 = pd.merge(left = hour_2021_반납, right = district.loc[:,['지역','대여소']], left_on = '반납자치구', right_on = '지역').drop('지역', axis=1)"),r("br"),t._v(" hour_2021_반납['이용시간'] = hour_2021_반납['이용시간']/hour_2021_반납['대여소']"),r("br"),t._v(" hour_2021_반납['이용거리'] = hour_2021_반납['이용거리']/hour_2021_반납['대여소']"),r("br"),t._v(" hour_2021_반납['이용횟수'] = hour_2021_반납['이용횟수']/hour_2021_반납['대여소']"),r("br"),t._v(" hour_2021_반납['상태'] = '반납'"),r("br"),t._v(" hour_2021_대여.columns = ['월', '요일', '시', '자치구', '이용시간', '이용거리', '이용횟수', '대여소', '상태']"),r("br"),t._v(" hour_2021_반납.columns = ['월', '요일', '시', '자치구', '이용시간', '이용거리', '이용횟수', '대여소', '상태']"),r("br"),t._v(" monthly_hourly_use = hour_2021_대여.groupby(['월', '시']).mean().reset_index().pivot(index='월', columns='시', values='이용횟수')"),r("br"),t._v(" fig = pivotToTimeplot(monthly_hourly_use, title='월별 시간별 대여소당 자전거 대여 추이', yaxis = '시', yRange=[0,18], order = False, duration=1000)"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/monthly_hourly_use.html",width:"800",height:"480",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 데이터를 정제하여 월별 시간별 대여소당 대여량의 평균값을 살펴보았다. 로그데이터로부터 1시간 단위로 대여량과 반납량을 나누어 묶었고, 이 그래프는 그 중 '대여량'에 대한 그래프이다. 1월에 이용자가 제일 적고 모든 월에서 출근/퇴근시간의 이용자가 제일 많은 것을 확인할 수 있다."),r("br"),r("br"),t._v(" 더워지는 7월-8월에는 출근시간의 이용자가 더 큰폭으로 감소하고 추워지는 10-11월에는 퇴근시간의 이용자가 더 큰폭으로 감소한다는 재밌는 점이 있지만, 그럼에도 월별로 보이는 차이는 스케일의 차이에 불과하지 그 양상은 서로 비슷해 보인다. ")])]),r("send-code",{attrs:{number:"23"}},[t._v(" weekly_hourly_borrow = hour_2021_대여.groupby(['요일','상태','시']).mean().reset_index().pivot(index='요일', columns='시', values='이용횟수')"),r("br"),t._v(" weekly_hourly_borrow.index = week"),r("br"),t._v(" weekly_hourly_borrow.index.name = '요일'"),r("br"),t._v(" fig = pivotToTimeplot(weekly_hourly_borrow, title='요일별 시간별 대여소당 자전거 대여 추이', yaxis = '시', yRange=[0,15], order = False, duration=1000)"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/weekly_hourly_borrow.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 평일의 대여는 모두 8시와 18시에 피크를 보이는 것을 알 수 있다. 출근시간과 퇴근시간이다. 정기권 이용자가 '이동을 위해' 자전거를 이용하는 움직임이 극대화되는 시간대이다. 흥미로운 점은 8시에 피크가 있기는 하나 그 양 자체는 17시와 19시에도 못미친다. 즉 날을 통틀어 시간이 지날수록 사용량이 점점 증가하다가 18시 이후 줄어들기 시작한다. 한편, 주말의 사용량은 잔잔하게 증가하기 시작해 16-17시에 피크를 찍는다. 평일과 주말은 그 양상에서 큰 차이를 보인다."),r("br"),r("br"),t._v(" 평일은 평일끼리 비슷하고, 주말은 주말끼리 비슷하다."),r("br"),r("br"),t._v(" 또 확인해본 결과, 각 날의 대여와 반납은 그리 큰 차이를 보이지 않는다. 사실 빌려도 2시간 안에 갖다놓아야하니 그렇게 큰 차이가 있기는 힘들다. 평균 이용시간이 20분정도에 크치는 것과 맥락이 상통한다. 법정공휴일은 어떨까 생각해보자. 법정공휴일은 출퇴근을 자전거로 하는 사람들의 이용압력이 없으므로 토, 일과 비슷한 양상을 보일 것이다. ")])]),r("send-code",{attrs:{number:"24"}},[t._v(" holiday_hourly_use = time_split_2021[(time_split_2021['대여월'] == 2) & (time_split_2021['대여일'] == 12)].groupby('대여시').size()"),r("br"),t._v(" holiday_hourly_use.name = '설날 대여량'"),r("br"),t._v(" fig = seriesPlot(holiday_hourly_use, title=None, order=None, orderArray=None,color=False, colorScale = None)"),r("br"),t._v(" holiday_hourly_use = time_split_2021[(time_split_2021['대여월'] == 5) & (time_split_2021['대여일'] == 5)].groupby('대여시').size()"),r("br"),t._v(" holiday_hourly_use.name = '어린이날 대여량'"),r("br"),t._v(" fig2 = seriesPlot(holiday_hourly_use, title=None, order=None, orderArray=None,color=False, colorScale = None)"),r("br"),t._v(" holiday_hourly_use = time_split_2021[(time_split_2021['대여월'] == 8) & (time_split_2021['대여일'] == 15)].groupby('대여시').size()"),r("br"),t._v(" holiday_hourly_use.name = '광복절 대여량'"),r("br"),t._v(" fig3 = seriesPlot(holiday_hourly_use, title=None, order=None, orderArray=None,color=False, colorScale = None)"),r("br"),t._v(" holiday_hourly_use = time_split_2021[(time_split_2021['대여월'] == 9) & (time_split_2021['대여일'] == 21)].groupby('대여시').size()"),r("br"),t._v(" holiday_hourly_use.name = '추석 대여량'"),r("br"),t._v(" fig4 = seriesPlot(holiday_hourly_use, title=None, order=None, orderArray=None,color=False, colorScale = None)"),r("br"),t._v(" holiday_hourly_use = time_split_2021[(time_split_2021['대여월'] == 10) & (time_split_2021['대여일'] == 9)].groupby('대여시').size()"),r("br"),t._v(" holiday_hourly_use.name = '한글날 대여량'"),r("br"),t._v(" fig5 = seriesPlot(holiday_hourly_use, title=None, order=None, orderArray=None,color=False, colorScale = None)"),r("br"),t._v(" holiday_hourly_use = time_split_2021[(time_split_2021['대여월'] == 12) & (time_split_2021['대여일'] == 25)].groupby('대여시').size()"),r("br"),t._v(" holiday_hourly_use.name = '크리스마스 대여량'"),r("br"),t._v(" fig6 = seriesPlot(holiday_hourly_use, title=None, order=None, orderArray=None,color=False, colorScale = None)"),r("br"),t._v(" del holiday_hourly_use"),r("br"),t._v(" fig = pxMerger([fig, fig2, fig3,fig4, fig5,fig6], 3, 2)"),r("br"),t._v(" fig.update_layout("),r("br"),t._v("     height=1000,"),r("br"),t._v("     width=1000,"),r("br"),t._v('     title_text="법정공휴일 시간별 대여량",'),r("br"),t._v("     xaxis_title = '시',"),r("br"),t._v("     yaxis1_title = '설날',"),r("br"),t._v("     yaxis2_title = '어린이날',"),r("br"),t._v("     yaxis3_title = '광복절',"),r("br"),t._v("     yaxis4_title = '추석',"),r("br"),t._v("     yaxis5_title = '한글날',"),r("br"),t._v("     yaxis6_title = '크리스마스'"),r("br"),r("br"),t._v("     )"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/holiday_hourly_use.html",width:"1025",height:"1030",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 법정공휴일의 이용량 또한 주말과 비슷한 양상을 보이는 것을 볼 수 있다. 서로의 그래프를 비교해보면 어떤 점을 발견할 수 있는데, 어두운 날에는(크리스마스, 설날) 더 이른시간에 타는 경향이 있다는 것이다. 설날과 크리스마스의 피크는 광복절과 추석의 피크보다 확실히 이른 시간에 있다."),r("br"),r("br"),t._v(" 겨울에는 이른 시간대에 이용이 몰리는 경향을 잡아내는 것은 이 분석이 해야하는 일 중 하나가 될 것이다. ")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-006",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},9022:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"row d-flex justify-content-center"},[r("div",{staticClass:"col-md-10"},[r("simple-wizard",[r("template",{slot:"header"},[r("h3",{staticClass:"card-title"},[t._v(t._s(t.$t("accont.signup")))]),r("h3",{staticClass:"description"},[t._v(" "+t._s(t.$t("accont.signupExplanation"))+" ")])]),r("wizard-tab",{attrs:{"before-change":function(){return t.validateStep("step1")}}},[r("template",{slot:"label"},[r("i",{staticClass:"tim-icons icon-single-02"}),r("p",[t._v("About")])]),r("first-step",{ref:"step1",on:{"on-validated":t.onStepValidated}})],2),r("wizard-tab",{attrs:{"before-change":function(){return t.validateStep("step2")}}},[r("template",{slot:"label"},[r("i",{staticClass:"tim-icons icon-settings-gear-63"}),r("p",[t._v("Account")])]),r("second-step",{ref:"step2",on:{"on-validated":t.wizardComplete}})],2)],2)],1)])])},s=[],o=r("ade3"),i=r("5530"),n=(r("ac1f"),r("5319"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ValidationObserver",{ref:"form"},[r("form",{on:{submit:function(e){return e.preventDefault(),t.validate.apply(null,arguments)}}},[r("div",[r("h5",{staticClass:"info-text"},[t._v(" "+t._s(t.$t("accont.firstStep"))+" ")]),r("div",{staticClass:"row justify-content-center flex-column align-items-center"},[r("div",{staticClass:"col-sm-6"},[r("ValidationProvider",{attrs:{name:t.$t("accont.lastName"),rules:"required|min:1|max:20|korAlpha"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{required:"",label:t.$t("accont.lastName"),error:o[0]},model:{value:t.form.last_name,callback:function(e){t.$set(t.form,"last_name",e)},expression:"form.last_name"}})]}}])})],1),r("div",{staticClass:"col-sm-6"},[r("ValidationProvider",{attrs:{name:t.$t("accont.firstName"),rules:"required|min:1|max:50|korAlpha"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{required:"",label:t.$t("accont.firstName"),error:o[0]},model:{value:t.form.first_name,callback:function(e){t.$set(t.form,"first_name",e)},expression:"form.first_name"}})]}}])})],1),r("div",{staticClass:"col-sm-6"},[r("ValidationProvider",{ref:"usernameValidation",attrs:{name:t.$t("accont.username"),rules:"required|korAlphaNum|min:5|max:20"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{required:"",label:t.$t("accont.username"),error:o[0]},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})]}}])})],1),r("div",{staticClass:"col-sm-6"},[r("ValidationProvider",{attrs:{name:t.$t("accont.password"),rules:"required|min:7|max:20|confirmed:confirmation"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{required:"",type:"password",label:t.$t("accont.password"),error:o[0]},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})]}}])})],1),r("div",{staticClass:"col-sm-6"},[r("ValidationProvider",{attrs:{name:t.$t("accont.confirmation"),vid:"confirmation",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{required:"",type:"password",label:t.$t("accont.confirmation"),error:o[0]},model:{value:t.form.confirmation,callback:function(e){t.$set(t.form,"confirmation",e)},expression:"form.confirmation"}})]}}])})],1),r("div",{staticClass:"col-md-6 category form-category text-end"},[t._v("* "+t._s(t.$t("accont.required")))])])])])])}),l=[],_=(r("00b4"),r("7bb1")),d=r("2ef0"),c=r.n(d);Object(_["extend"])("korAlpha",{validate:function(t){var e=/^[가-힣|aA-zZ]*$/.test(t);return!!e||$("validation.korAlpha")}}),Object(_["extend"])("korAlphaNum",{validate:function(t){var e=/^[가-힣|aA-zZ|0-9]*$/.test(t);return!!e||$("validation.korAlphaNum")}});var b={data:function(){return{form:{first_name:"",last_name:"",username:"",password:"",confirmation:""}}},methods:{validate:function(){var t=this;return this.$refs.form.validate().then((function(e){return t.$emit("on-validated",e,t.form),e}))}},watch:{"form.username":c.a.debounce((function(){var t=this;this.$http.get("http://localhost:8000/api/seoulbike/user/namecheck/?username=".concat(this.form.username)).then((function(e){1!==e.data.checked?t.$refs.usernameValidation.setErrors([t.$t("validation.nameExist")]):t.$refs.usernameValidation.validate()})).catch((function(e){t.$refs.usernameValidation.setErrors([t.$t("validation.nameFail")])}))}),1e3)}},v=b,u=r("2877"),p=Object(u["a"])(v,n,l,!1,null,null,null),m=p.exports,f=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ValidationObserver",{ref:"form"},[r("form",{on:{submit:function(e){return e.preventDefault(),t.validate.apply(null,arguments)}}},[r("div",[r("h4",{staticClass:"info-text"},[t._v(" "+t._s(t.$t("accont.secondStep"))+" ")]),r("h6",{staticClass:"info-text"},[t._v(" *"+t._s(t.$t("accont.emailExplanation"))+" ")]),r("div",{staticClass:"justify-content-center mt-5"},[r("div",{staticClass:"row flex-column align-items-center"},[r("div",{staticClass:"row"},[r("image-upload",{staticClass:"imgupload",attrs:{type:"avatar","select-text":"추가","remove-text":"삭제","change-text":"변경"},on:{change:t.onImageChange}})],1),r("div",{staticClass:"col-sm-6 my-1"},[r("ValidationProvider",{attrs:{name:t.$t("accont.email"),rules:"email"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{placeholder:t.$t("accont.email"),"addon-left-icon":"tim-icons icon-email-85",error:o[0]},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})]}}])})],1),r("modal",{attrs:{show:t.modalShow,headerClasses:"justify-content-center",showClose:!1},on:{"update:show":function(e){t.modalShow=e}}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("h4",{staticClass:"title title-up"},[t._v(t._s(t.$t("accont.bikespotselect")))])]),r("p",{staticClass:"description"},[t._v(t._s(t.$t("accont.bikespotselectExplanation")))]),t.modalShow?r("spot-map",{attrs:{mode:"multiple",selectedBikespot:t.newSelectedBikespot},on:{bikeSpots:t.bikeSpots}}):t._e(),r("p",{staticClass:"description p-3 pt-3"},[r("strong",[t._v(t._s(this.selectedBikespotString))])]),r("template",{slot:"footer"},[r("div",[r("base-button",{staticClass:"my-3",attrs:{type:"danger"},on:{click:t.DeleteSpot}},[t._v(t._s(t.$t("accont.deleteAll")))]),r("base-button",{staticClass:"my-3 mx-3",attrs:{type:"danger"},on:{click:t.CancelSpot}},[t._v(t._s(t.$t("accont.cancel")))])],1),r("base-button",{staticClass:"m-3",on:{click:t.Okayspot}},[t._v(t._s(t.$t("accont.confirm"))+" ")])],1)],2),r("div",{staticClass:"col-sm-6 my-1"},[r("ValidationProvider",{attrs:{name:t.$t("accont.user_spots"),rules:""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{placeholder:t.$t("accont.user_spots"),"addon-left-icon":"tim-icons icon-map-big",error:o[0]},on:{focus:t.modalFunc},model:{value:t.form.user_spots,callback:function(e){t.$set(t.form,"user_spots",e)},expression:"form.user_spots"}})]}}])})],1)],1)])])])])},h=[],g=(r("a15b"),r("d81d"),r("fb6a"),r("bc3a"),r("2af9")),y=r("63e4");Object(_["extend"])("phone",{validate:function(t){var e=/^[0-9]{3,4}-[0-9]{3,4}-[0-9]{4}$/.test(t);return!!e||$t("validation.phone")}});var x={components:{ImageUpload:g["i"],SpotMap:y["a"],Modal:g["k"]},data:function(){return{form:{image:"",email:"",user_spots:""},modalShow:!1,selectedBikespot:[],newSelectedBikespot:[]}},computed:{selectedBikespotString:function(){return this.newSelectedBikespot.map((function(t){return t+"번"})).join(", ")}},methods:{onImageChange:function(t){this.form.image=t},modalFunc:function(){this.modalShow=!0},validate:function(){var t=this;return this.$refs.form.validate().then((function(e){if(e)return t.$emit("on-validated",e,t.form),e}))},bikeSpots:function(t){this.newSelectedBikespot=t},DeleteSpot:function(){this.modalShow=!1,this.newSelectedBikespot=[],this.selectedBikespot=[],this.form.user_spots=""},CancelSpot:function(){this.modalShow=!1,this.newSelectedBikespot=this.selectedBikespot.slice()},Okayspot:function(){this.selectedBikespot=this.newSelectedBikespot.slice(),this.form.user_spots=this.selectedBikespot.join(", "),this.modalShow=!1}}},w=x,C=(r("f6cd"),Object(u["a"])(w,f,h,!1,null,null,null)),k=C.exports,S=r("3d20"),j=r.n(S),F=r("2f62"),N={data:function(){return{wizardModel:{}}},components:{FirstStep:m,SecondStep:k,SimpleWizard:g["l"],WizardTab:g["o"]},methods:{validateStep:function(t){return this.$refs[t].validate()},onStepValidated:function(t,e){this.wizardModel=Object(i["a"])(Object(i["a"])({},this.wizardModel),e)},wizardComplete:function(t,e){this.wizardModel=Object(i["a"])(Object(i["a"])({},this.wizardModel),e),this.submit(this.wizardModel)},submit:function(t){var e=this;console.log(t),this.$http({method:"POST",url:"http://localhost:8000/api/seoulbike/user/",data:t,headers:{"Content-Type":"multipart/form-data"}}).then((function(t){var r;j.a.fire((r={title:e.$t("accont.welcome"),text:e.$t("accont.singupSuccess"),showCancelButton:!0,customClass:{confirmButton:"btn btn-success btn-fill",cancelButton:"btn btn-info btn-fill"},confirmButtonText:e.$t("accont.confirm"),cancelButtonText:e.$t("accont.gotoMain")},Object(o["a"])(r,"customClass",{confirmButton:"btn btn-success btn-fill"}),Object(o["a"])(r,"icon","success"),r)).then((function(t){t.value?e.$router.replace({path:"/users/login"}):e.$router.replace({path:"/"})}))})).catch((function(t){e.$errorHandler(t)}))}},computed:Object(i["a"])({},Object(F["c"])(["isLoggedIn"])),created:function(){this.isLoggedIn&&this.$router.push("/")}},B=N,D=Object(u["a"])(B,a,s,!1,null,null,null);e["default"]=D.exports},"922b":function(t,e,r){},"945c":function(t,e,r){},"970e":function(t,e,r){},a466:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("div",{staticClass:"col-lg-4 col-md-6 ml-auto mr-auto"},[r("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(e){var a=e.handleSubmit;return[r("form",{on:{submit:function(e){return e.preventDefault(),a(t.submit)}}},[r("card",{staticClass:"card-login card-white"},[r("template",{slot:"header"},[r("img",{attrs:{src:"img/card-primary.png",alt:""}}),r("h1",{staticClass:"card-title"},[t._v(t._s(t.$t("accont.login")))])]),r("div",[r("ValidationProvider",{attrs:{name:t.$t("accont.id"),rules:"required|min:7|max:20|korAlphaNum"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{required:"",type:"id",placeholder:t.$t("accont.username"),"addon-left-icon":"tim-icons icon-email-85",error:o[0]},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})]}}],null,!0)}),r("ValidationProvider",{attrs:{name:t.$t("accont.password"),rules:"required|min:5|max:20"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{required:"",placeholder:t.$t("accont.password"),"addon-left-icon":"tim-icons icon-lock-circle",type:"password",error:o[0]},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})]}}],null,!0)})],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("base-button",{staticClass:"mb-3",attrs:{"native-type":"submit",type:"primary",size:"lg",block:""}},[t._v(" "+t._s(t.$t("accont.doLogin"))+" ")]),r("div",{staticClass:"pull-left"},[r("h6",[r("router-link",{staticClass:"link footer-link",attrs:{to:"/users/signup"}},[t._v(" "+t._s(t.$t("accont.signup"))+" ")])],1)]),r("div",{staticClass:"pull-right"},[r("h6",[r("a",{staticClass:"link footer-link",staticStyle:{cursor:"pointer"},on:{click:function(e){t.emailForm=!t.emailForm}}},[t._v(t._s(t.emailForm?t.$t("accont.findpwCancel"):t.$t("accont.findpw")))])])])],1)],2)],1)]}}])})],1),r("transition",{attrs:{name:"emailfade"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:t.emailForm,expression:"emailForm"}],staticClass:"col-lg-5 col-md-8 ml-auto mr-auto"},[r("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(e){var a=e.handleSubmit;return[r("form",{on:{submit:function(e){return e.preventDefault(),a(t.emailSubmit)}}},[r("card",[r("h5",{staticClass:"title",attrs:{slot:"header"},slot:"header"},[t._v(t._s(t.$t("accont.inputEmail")))]),r("p",{staticClass:"card-description"},[t._v(t._s(t.$t("accont.inputEmailExplanation")))]),r("ValidationProvider",{attrs:{name:t.$t("accont.email"),rules:"email"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.passed,s=e.failed,o=e.errors;return[r("base-input",{class:[{"has-success":a},{"has-danger":s}],attrs:{placeholder:t.$t("accont.email"),"addon-left-icon":"tim-icons icon-email-85",error:o[0]},model:{value:t.forgotemail,callback:function(e){t.forgotemail=e},expression:"forgotemail"}})]}}],null,!0)}),r("base-button",{staticClass:"btn-fill btn-block",attrs:{"native-type":"submit",type:"primary"}},[r("i",{staticClass:"tim-icons icon-pencil",staticStyle:{"font-size":"1.3rem"}}),t._v(" "+t._s(t.$t("accont.submit"))+" ")])],1)],1)]}}])})],1)])],1)},s=[],o=r("5530"),i=(r("ac1f"),r("00b4"),r("7bb1")),n=r("2f62"),l=r("3d20"),_=r.n(l),d=r("e931"),c=void 0;Object(i["extend"])("korAlphaNum",{validate:function(t){var e=/^[가-힣|aA-zZ|0-9]*$/.test(t);return!!e||c.$t("validation.korAlphaNum")}});var b={data:function(){return{username:"",password:"",subscribe:!0,nextPath:"/",emailForm:!1,forgotemail:""}},mounted:function(){"next"in this.$route.query&&(this.nextPath=this.$route.query.next)},methods:Object(o["a"])(Object(o["a"])({},Object(n["b"])(["login"])),{},{submit:function(){var t=this;this.login({username:this.username,password:this.password}).then((function(e){Object(d["a"])(e),t.$router.push(t.nextPath)})).catch((function(e){console.log(e),401===e.response.status?_.a.fire({title:"정보 없음",text:"아이디 또는 비밀번호가 일치하지 않습니다.",timer:2e3,icon:"warning",confirmButtonClass:"btn btn-warning btn-fill",buttonsStyling:!1}):t.$errorHandler(e)}))},emailSubmit:function(){var t=this;this.$http.post("http://localhost:8000/api/auth/password_reset/",{email:this.forgotemail}).then((function(e){console.log(e),_.a.fire({title:"전송 완료",text:"".concat(t.forgotemail,"로 이메일을 전송했습니다."),timer:5e3,icon:"success",confirmButtonClass:"btn btn-success btn-fill",buttonsStyling:!1})})).catch((function(e){t.$errorHandler(e)}))}}),computed:Object(o["a"])({},Object(n["c"])(["isLoggedIn"])),created:function(){this.isLoggedIn&&this.$router.push("/")}},v=b,u=(r("7479"),r("2877")),p=Object(u["a"])(v,a,s,!1,null,null,null);e["default"]=p.exports},a8e5:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("div",{staticClass:"typography-line"}),r("send-code",{attrs:{number:"18"}},[t._v(' fig = px.bar(new_members.groupby([\'연령대\',\'성별\']).sum().loc[:,[\'가입수\']].reset_index(), x="연령대", y="가입수", color="성별", title="연령대별 성별에 따른 가입인원수")'),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/age_sex_members.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 위의 차트는 연령대별 성별 가입인원수를 나타낸 것이다. 성별에 관계없이 20대가 제일 많고, 30대, 40대 순으로 점점 나이가 들수록 가입인원이 줄어드는 것을 볼 수 있다. 그러나 60대보다 70대가 더 많은데, 이는 성별을 판별할 수 있는 경우에서는 해당되지 않으나, 위에서 보았던 70대 이상의 None의 값이 비정상적으로 높아 성별을 입력하지 않은 경우의 연령대설정이 기본이 70대 이상으로(예 : 생일이 1900년 1월 1일로 설정)되어있다든가 하는 문제가 있는 것으로 생각된다."),r("br"),r("br"),t._v(" N/F+M의 비가 연령이 올라갈 수록 낮아지기 때문에(앱의 설치에 익숙하지 않다는 점을 고려하면) 70대 N은 총합계 2000이 되지 않을 것으로 예상한다. ")])]),r("send-code",{attrs:{number:"19"}},[t._v(" new_members[(new_members['연령대']=='70대이상') & (new_members['성별']=='None')]['가입수'].describe() ")]),r("receive-code",[t._v(" count 546.000000"),r("br"),t._v(" mean 176.282051"),r("br"),t._v(" std 635.033292"),r("br"),t._v(" min 1.000000"),r("br"),t._v(" 25% 2.000000"),r("br"),t._v(" 50% 5.000000"),r("br"),t._v(" 75% 11.750000"),r("br"),t._v(" max 5706.000000"),r("br"),t._v(" Name: 가입수, dtype: float64 ")]),r("div",{staticClass:"typography-line"},[r("p",[t._v(" 연령대가 70대 이상이고 성별이 None인 row들에 대해 describe함수를 사용해보았다. 75% quantile의 값은 11이지만 mean은 176, max값이 5706인 것으로 보아, 실제 추이에서 벗어나는 이상치들이 존재하는 것이 확실해졌다. 어느 시기의 이용자 정보들이 제대로 기록되지 않고 청크로 처리해서 넘긴 것으로 추측할 수 있었다. 연령대가 70대 이상이면서 성별은 None이고 하루 가입 수가 100이 넘는 값들의 연령대를 모두 기타로 처리했다.(100항밖에 되지 않았다.) ")])]),r("send-code",{attrs:{number:"20"}},[t._v(" new_members.loc[(new_members['연령대']=='70대이상') & (new_members['성별']=='None') & (new_members['가입수']>100),'연령대'] = '기타'"),r("br"),t._v(' fig = px.bar(new_members.groupby([\'연령대\',\'성별\']).sum().loc[:,[\'가입수\']].reset_index(), x="연령대", y="가입수", color="성별", title="연령대별 성별에 따른 가입인원수")'),r("br"),t._v(" fig.show() ")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/age_sex_members2.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 70대 N이 2000정도가 나오도록 조작하지 않고도, 이치에 맞도록 그래프의 형태가 바뀐 것을 볼 수 있다. 훨씬 더 직관적이다. ")])]),r("send-code",{attrs:{number:"21"}},[t._v(" fig = px.pie(new_members.groupby(['연령대']).sum(), values='가입수', title=\"연령별 가입인원 비율\",names=new_members.groupby(['연령대']).sum().index)"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/age_members.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 연령별 가입인원은 다음과 같았다. 연령대를 알수 없는 기타 항목을 제외하면 20대가 거의 50%에 육박하여 제일 많았으며(차트에서 기타 항목을 클릭하면 빠진다), 30대, 40대, 10대, 50대, 60대, 70대 이상 순이었다. 직관적으로 예상 가능했던 부분으로 앱에 대한 접근성, 활동량, 그리고 자전거 대여 목적을 생각하면(자전거를 운동용으로 탄다면 40,50대가 더 많이 탈 것으로 생각되나 공유시스템의 자전거를 단순 운동 목적으로 타는 사람의 비율은 별로 높지 않을 것이다.) 이해가 가는 결과다. ")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-007",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},a972:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("send-code",{attrs:{number:"13"}},[t._v(' m = folium.Map(location=[37.55, 126.98], titles="따릉이 대여소 이용현황", zoom_start=12)'),r("br"),r("br"),t._v(" for i in range(0,len(metro_use_relation)):"),r("br"),t._v("     latitude = metro_use_relation.iloc[i]['위도']"),r("br"),t._v("     longitude = metro_use_relation.iloc[i]['경도']"),r("br"),t._v("     location=(latitude, longitude)"),r("br"),t._v("     use = metro_use_relation.iloc[i]['이용건수']"),r("br"),t._v("     red = str(hex(int((int(float(use))//10000)/7*(0-56)+56))).replace('0x', '').zfill(2)"),r("br"),t._v("     green = str(hex(int((int(float(use))//10000)/7*(75-176)+176))).replace('0x', '').zfill(2)"),r("br"),t._v("     blue = str(hex(int((int(float(use))//10000)/7*(35-0)+0))).replace('0x', '').zfill(2)"),r("br"),t._v("     opacity = str(hex(int((int(float(use))//10000)/7*(255-180)+180))).replace('0x', '').zfill(2)"),r("br"),t._v("     color = '#'+red+green+blue+opacity"),r("br"),r("br"),t._v("     folium.CircleMarker(location, radius=(metro_use_relation.iloc[i]['이용건수']/400)**0.5,color=color,fill_color=color,"),r("br"),t._v("                         popup='이용건수 : '+str(metro_use_relation.iloc[i]['이용건수'])).add_to(m)"),r("br"),r("br"),r("br"),t._v(" folium.LayerControl(collapsed=False).add_to(m)"),r("br"),t._v(" m"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/spot_use_map.html",width:"800",height:"480",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 따릉이 대여소 각각 그 이용량이 면적에 비례하는 원을 그리면 다음과 같았다. 서울 외각으로 나갈수록 원의 크기가 점점 작아지는 경향성을 확인할 수 있다. 강서구, 영등포구와, 송파구, 광진구의 활발한 이용률이 보인다. 중구, 노원구, 서초구, 강남구는 대여소마다 매우 고르게 이용하는 모습을 볼 수 있다."),r("br"),r("br"),t._v(" 한편 따릉이의 이용 분포를 파악하는 것은 힘든 문제임이 드러났는데, 왜냐하면 적은 몇 개의 대여소에서 지나치게 많은 이용량을 보이는 것이 확인되었기 때문이다. 당초의 계획은 구별로 클러스터화 하는 것이었는데, 이러한 분포를 보여서야 구 단위로 어떤 경향성을 찾겠다는 것은, 말그대로 '경향성'의 수준에서는 가능할지 몰라도 예측의 측면에서는 부질없는 시도일 것이라는 생각이 들었다. 만약 그렇다면, 2600개나 되는 대여소에 대해 원핫 인코딩을 하거나 모델을 다 따로 만들어야(이것이 훨씬 현실적이다) 할 것이다. ")])]),r("send-code",{attrs:{number:"14"}},[t._v(" from selenium import webdriver"),r("br"),t._v(" from selenium.webdriver.common.by import By"),r("br"),t._v(" from selenium.webdriver.common.keys import Keys"),r("br"),t._v(" from selenium.webdriver.support.ui import WebDriverWait"),r("br"),t._v(" from selenium.webdriver.support import expected_conditions as EC"),r("br"),r("br"),t._v(" import time"),r("br"),t._v(" import requests"),r("br"),t._v(" from bs4 import BeautifulSoup"),r("br"),t._v(" import re"),r("br"),t._v(' driver = webdriver.Chrome("../chromedriver")'),r("br"),r("br"),t._v(' driver.get("https://map.naver.com/v5/directions")'),r("br"),r("br"),t._v(" try:"),r("br"),t._v('     start_input = WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#directionStart0")))'),r("br"),t._v('     direction_input = WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#directionGoal1")))'),r("br"),t._v(" except:"),r("br"),t._v("     driver.close()"),r("br"),r("br"),t._v(" N = len(share_spot['대여소번호'])"),r("br"),t._v(" number = share_spot['대여소번호']"),r("br"),t._v(" dist = share_spot['자치구']"),r("br"),t._v(" addr = share_spot['상세주소']"),r("br"),t._v(" distance_set = []"),r("br"),t._v(" p = re.compile('(^[가-힣]+역)')     #역 이름 찾기"),r("br"),t._v(" for k in range(len(share_spot['대여소번호'])):"),r("br"),t._v("     start_addr = addr[k].replace('지하', '').replace('  ', ' ').strip() #'지하'라고 써져있을 경우 검색이 안됨"),r("br"),t._v("     if dist[k] not in start_addr:"),r("br"),t._v('         start_addr = dist[k] +" " +start_addr'),r("br"),t._v("    "),r("br"),t._v("     print(start_addr, '찾을 차례')"),r("br"),t._v("     start_input.clear()"),r("br"),t._v("     start_input.send_keys(start_addr)"),r("br"),t._v("     start_input.send_keys(Keys.ENTER)"),r("br"),t._v("     time.sleep(0.5)"),r("br"),t._v("     direction_input.clear()"),r("br"),t._v('     direction_input.send_keys("지하철")#지하철 검색'),r("br"),t._v("     direction_input.send_keys(Keys.ENTER)"),r("br"),t._v("     time.sleep(0.8)"),r("br"),t._v('     wait_until = WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.CSS_SELECTOR, "button.icon_directions")))'),r("br"),t._v('     list_search = WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.CSS_SELECTOR, "div.list_search")))'),r("br"),t._v("     result_names = list_search.find_elements_by_css_selector('.link_search .search_title_text')"),r("br"),r("br"),t._v("     print('역 목록 확인중')"),r("br"),t._v("    "),r("br"),r("br"),t._v("     station_names = []  #클릭하여 거리를 잴 대상들/ 중복된 역이 있는지 확인할 list"),r("br"),t._v("     distance_list = []   #역으로부터 거리가 저장됨"),r("br"),t._v("     for i in range(len(result_names)):"),r("br"),t._v("         result_name = result_names[i].text"),r("br"),t._v("         try:      #역 이름이 존재하는 지 확인"),r("br"),t._v("             m = p.match(result_name)"),r("br"),t._v("             station_name = m.group()"),r("br"),t._v("             if(station_name not in station_names):   #중복되지 않으면 추가"),r("br"),t._v("                 station_names.append(station_name)"),r("br"),t._v("                 if len(station_names) >=3:  #맨 앞의 3개 역만 확인"),r("br"),t._v("                     break"),r("br"),t._v("         except:"),r("br"),t._v("             continue"),r("br"),t._v("     print('역 목록 확인완료', station_names)"),r("br"),t._v("     for i in range(len(station_names)):"),r("br"),t._v("         if len(start_input.get_attribute('value')) < 1:"),r("br"),t._v("             start_input.send_keys(start_addr)"),r("br"),t._v("             start_input.send_keys(Keys.ENTER)"),r("br"),t._v("             time.sleep(0.5)"),r("br"),t._v("         direction_input.clear()"),r("br"),t._v("         direction_input.send_keys(station_names[i])"),r("br"),t._v("         direction_input.send_keys(Keys.ENTER)"),r("br"),t._v("         time.sleep(0.5)"),r("br"),t._v("         direction_button = driver.find_element_by_css_selector('button.btn.btn_direction')"),r("br"),t._v("         direction_button.click()"),r("br"),t._v("         time.sleep(0.5)"),r("br"),t._v("         walk_button = driver.find_element_by_css_selector('a.link_tab.walk')"),r("br"),t._v("         walk_button.click()"),r("br"),t._v("         try:"),r("br"),t._v('             distance = WebDriverWait(driver, 5).until(EC.presence_of_element_located((By.CSS_SELECTOR, ".summary_box .summary_text")))'),r("br"),t._v("             distance_list.append(distance.text)"),r("br"),t._v("         except:"),r("br"),t._v("             distance_list.append('50km')  ##50km 이상일경우에는 제공하지 않음"),r("br"),t._v("         print('역 확인', i+1, '번째 완료')"),r("br"),t._v("     distance_set.append(dict(zip(station_names, distance_list)))"),r("br"),t._v("    "),r("br"),t._v("     print(str(k+1)+'/'+str(N),(k+1)/N*100 ,  '% 완료')"),r("br"),t._v(" driver.close()"),r("br")]),r("send-code",{attrs:{number:"15"}},[t._v(" metro_use_relation = daily_use[daily_use['대여일자']>='2022-01-01'].loc[:,['번호','이용건수']].groupby('번호').sum()"),r("br"),t._v(" metro_use_relation = pd.merge(left =metro_use_relation,right =  share_spot.loc[:,['대여소번호','근처역','근처역거리', '위도','경도']], how='left', left_on =metro_use_relation.index, right_on='대여소번호')"),r("br"),t._v(" metro_use = getAllCsvDask('지하철이용량')"),r("br"),t._v(" for i in range(len(metro_use)):"),r("br"),t._v("     metro_use[i].columns = ['노선명', '역명', '승차총승객수', '하차총승객수', '등록일자','wrongField']"),r("br"),t._v(" metro_use = pd.concat(metro_use)"),r("br"),t._v(" metro_use.index.name = '사용일자'"),r("br"),t._v(" metro_use.reset_index(inplace=True)"),r("br"),t._v(" metro_use['사용일자'] = pd.to_datetime(metro_use['사용일자'].astype(str).str.slice(0,4)+'-'+metro_use['사용일자'].astype(str).str.slice(4,6)+'-'+metro_use['사용일자'].astype(str).str.slice(6,8))"),r("br"),t._v(" metro_use['총승객수'] = metro_use['승차총승객수']+metro_use['하차총승객수']"),r("br"),t._v(" metro_use.drop(['등록일자','wrongField'], axis=1, inplace=True)"),r("br"),t._v(" metro_station_use = metro_use.groupby('역명').sum()"),r("br"),t._v(" metro_station_use.index = metro_station_use.index + '역'"),r("br"),t._v(' metro_station_use.index = metro_station_use.index.str.replace(r"\\((.*)\\)", "") #괄호 제거'),r("br"),t._v(" metro_use_relation = pd.merge(left = metro_use_relation,right = metro_station_use,how='inner', left_on='근처역' , right_on=metro_station_use.index)"),r("br"),t._v(" metro_use_relation.drop(['하차총승객수', '승차총승객수'], axis=1, inplace=True)"),r("br"),t._v(" res = ols('이용건수 ~ 근처역거리 + 총승객수', data=metro_use_relation).fit()"),r("br"),t._v(" fitted = res.predict(metro_use_relation)"),r("br"),t._v(" res.summary()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("img",{staticClass:"frame",staticStyle:{"background-color":"#fff"},attrs:{src:"http://localhost:8000/static/figures/metro_use_relation_ols.png"}})]),r("send-code",{attrs:{number:"16"}},[t._v(" residual = metro_use_relation['이용건수'] - fitted"),r("br"),t._v(" fig = plt.figure(figsize=(20, 5))"),r("br"),t._v(" ax1 = fig.add_subplot(1,3,1)"),r("br"),t._v(" ax2 = fig.add_subplot(1,3,2)"),r("br"),t._v(" ax3 = fig.add_subplot(1,3,3)"),r("br"),t._v(" sns.regplot(fitted, residual, lowess=True, line_kws={'color': 'red'}, ax=ax1 )"),r("br"),t._v(" stats.probplot(residual, dist=stats.norm,plot=ax2)"),r("br"),t._v(" sr = stats.zscore(residual)"),r("br"),t._v(" sns.regplot(fitted, np.sqrt(np.abs(sr)), lowess=True, line_kws={'color': 'red'}, ax=ax3 )"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("img",{staticClass:"frame",staticStyle:{"background-color":"#fff"},attrs:{src:"http://localhost:8000/static/figures/metro_use_relation_pp.png"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 대여소 별로 이용량을 파악할 좋은 방법이 있을까 생각하던 와중, 주변에 지하철 역이 있다면 그 이용량이 어떻게 변화하는지 궁금해졌다. 주변에 지하철 역이 있다면 사람들이 많이 통행하는 곳이라는 의미이므로 따릉이를 타려는 사람들도 많겠지만, 지하철 역 자체가 따릉이를 타려는 사람들에게 그것이 일종의 타지 않게끔하는 압력이 될 수 도 있다고 생각했기 때문에 회귀분석을 해보기로 했다. 2653개 대여소에 대해 제일 가까운 지하철역까지의 거리를 측정해야 하므로 selenium을 사용했다. (selenium.ipynb) 16개 대여소에서는 작동하지 않아 손으로 입력했다."),r("br"),r("br"),t._v(" 지하철역 및 대여소가 세워진 일자 또한 제각각이므로 이에 받는 영향을 최소화하기 위해 2022년의 정보만 가지고 평가했다. 또 근처의 지하철 역이 붐비는 역일 경우, 사람 자체가 많아 사용량에 유의미한 영향을 줄 것으로 생각되므로 각 역의 이용량 또한 종속변수로 추가했다."),r("br"),r("br"),r("strong",[t._v(" F-검정 귀무 가설: 절편만 있는 모형과 모형의 적합성이 동일"),r("br"),t._v(" 대립 가설: 절편만 있는 모형보다 모형의 적합성이 유의하게 높음"),r("br"),r("br")]),t._v(" F-검정의 statistic의 p-value는 3e-26수준으로 회귀모형이 통계적 유의성을 가진 다는 것을 확인할 수 있다."),r("br"),r("br"),r("strong",[t._v(" 각 계수에 대한 t검정 귀무 가설: 값이 0인 모형과 설명력이 동일"),r("br"),t._v(" 대립 가설: 값이 0인 모형보다 설명력이 유의하게 높음"),r("br"),r("br")]),t._v(" t값이 절편에 대해 28.5, 거리에 대해 -8.6, 승객수에 대해 6.8 수준으로 '의심의 여지가 없이' 높은 것을 확인할 수 있다. 그러나 qq plot의 모양과 오차항의 잔차의 모양이 좋지않다. 잔차의 정규성과 등분산성이 만족하지 않으므로 이 모형을 채택할 수 없다. log변환을 실행한 후 다시 시도해보자."),r("br")])]),r("send-code",{attrs:{number:"17"}},[t._v(" cd, _ = OLSInfluence(res).cooks_distance"),r("br"),t._v(" cd.sort_values(ascending=False)[1:10]"),r("br"),t._v(" #1527, 17, 387, 1531, 5, 1354의 자료가 극단 값으로 보이고 이들을 제거해보기로 한다."),r("br"),t._v(" metro_use_relation_log = metro_use_relation.copy()"),r("br"),t._v(" metro_use_relation_log.drop([1527, 17, 387, 1531, 5, 1354], inplace=True)"),r("br"),t._v(" metro_use_relation_log['이용건수'] = np.log1p(metro_use_relation_log['이용건수'])"),r("br"),r("br"),t._v(" res = ols('이용건수 ~ 근처역거리 + 총승객수', data=metro_use_relation_log).fit()"),r("br"),t._v(" fitted = res.predict(metro_use_relation_log)"),r("br"),t._v(" residual = metro_use_relation_log['이용건수'] - fitted"),r("br"),t._v(" fig = plt.figure(figsize=(20, 5))"),r("br"),t._v(" ax1 = fig.add_subplot(1,3,1)"),r("br"),t._v(" ax2 = fig.add_subplot(1,3,2)"),r("br"),t._v(" ax3 = fig.add_subplot(1,3,3)"),r("br"),t._v(" sns.regplot(fitted, residual, lowess=True, line_kws={'color': 'red'}, ax=ax1 )"),r("br"),t._v(" stats.probplot(residual, dist=stats.norm,plot=ax2)"),r("br"),t._v(" sr = stats.zscore(residual)"),r("br"),t._v(" sns.regplot(fitted, np.sqrt(np.abs(sr)), lowess=True, line_kws={'color': 'red'}, ax=ax3 )"),r("br"),t._v(" fig.show()"),r("br"),t._v(" res.summary()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("img",{staticClass:"frame",staticStyle:{"background-color":"#fff"},attrs:{src:"http://localhost:8000/static/figures/metro_use_relation_log_ols.png"}})]),r("div",{staticClass:"d-flex justify-content-center"},[r("img",{staticClass:"frame",staticStyle:{"background-color":"#fff"},attrs:{src:"http://localhost:8000/static/figures/metro_use_relation_log_pp.png"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 이번엔 분포가 너무 치우치지 않고 적당히 잘 나온 것 같으므로 이 회귀모형을 채택하자. 그러면 log(이용건수) = 8.5487 - 0.0003(근처역거리) + 2.173e-8(총승객수) => (이용건수) = 5160/e^(0.0003(근처역거리))*e^(2.173e-8(총승객수))"),r("br"),r("br"),t._v(" 이용건수는 근처역의 6개월단위 총승객수가 531만명 늘 수록 2배씩 늘며 반대로 2310미터 거리가 멀어질마다 절반으로 주는 경향이 있다는 사실을 알 수 있다. ")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-004",components:{sendCode:o["a"],receiveCode:i["a"],SendCode:o["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},bb2f:function(t,e,r){var a=r("d039");t.exports=!a((function(){return Object.isExtensible(Object.preventExtensions({}))}))},bb8e:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("div",{staticClass:"typography-line"},[r("p",[t._v("코드는 다음과 같이 표기한다. 분석하는 동안 import했던 모듈의 총 집합이다.")])]),r("send-code",{attrs:{number:"1"}},[t._v(" import numpy as np"),r("br"),t._v(" import pandas as pd "),r("br"),t._v(" import os"),r("br"),t._v(" import json"),r("br"),t._v(" import time"),r("br"),t._v(" import hashlib"),r("br"),t._v(" from os import listdir"),r("br"),t._v(" from os.path import isfile, join"),r("br"),t._v(" from copy import deepcopy"),r("br"),r("br"),t._v(" import datatable as dt"),r("br"),t._v(" import dask.dataframe as dd"),r("br"),t._v(" import datetime"),r("br"),r("br"),t._v(" import folium"),r("br"),t._v(" import dash_bio"),r("br"),t._v(" from plotly.subplots import make_subplots"),r("br"),t._v(" import plotly.graph_objects as go"),r("br"),t._v(" import plotly.express as px"),r("br"),t._v(" import plotly.offline as pyo"),r("br"),t._v(" from folium.plugins import HeatMap"),r("br"),t._v(" import matplotlib.pyplot as plt"),r("br"),t._v(" import seaborn as sns"),r("br"),t._v(" from IPython.display import Image"),r("br"),t._v(" from matplotlib import font_manager"),r("br"),r("br"),t._v(" import scipy.stats as stats"),r("br"),t._v(" from scipy.signal import periodogram"),r("br"),r("br"),t._v(" from matplotlib import rcParams"),r("br"),r("br"),t._v(" import statsmodels.api as sm"),r("br"),t._v(" from statsmodels.formula.api import ols"),r("br"),t._v(" from statsmodels.stats.outliers_influence import OLSInfluence"),r("br"),t._v(" from statsmodels.tsa.stattools import kpss"),r("br"),t._v(" from statsmodels.tsa.deterministic import CalendarFourier, DeterministicProcess"),r("br"),r("br"),t._v(" from sklearn.neighbors import KNeighborsClassifier"),r("br"),t._v(" from sklearn.preprocessing import MinMaxScaler, power_transform, StandardScaler"),r("br"),t._v(" from sklearn.metrics import mean_squared_error, mean_absolute_error, make_scorer, accuracy_score, log_loss"),r("br"),t._v(" from sklearn.model_selection import train_test_split , TimeSeriesSplit, GridSearchCV, ParameterGrid"),r("br"),t._v(" from sklearn.linear_model import LinearRegression , Ridge , Lasso, ElasticNet, LassoLars, SGDRegressor, Perceptron, LogisticRegression"),r("br"),t._v(" from sklearn.ensemble import RandomForestRegressor, GradientBoostingRegressor, ExtraTreesRegressor,AdaBoostRegressor, RandomForestClassifier, GradientBoostingClassifier, ExtraTreesClassifier, VotingClassifier"),r("br"),t._v(" from sklego.meta import ZeroInflatedRegressor"),r("br"),r("br"),t._v(" from xgboost import XGBRegressor, XGBClassifier"),r("br"),t._v(" from lightgbm import LGBMRegressor, LGBMClassifier"),r("br"),r("br"),t._v(" import multiprocessing"),r("br"),t._v(" import gplearn as gpl"),r("br"),t._v(" from gplearn.genetic import SymbolicRegressor "),r("br"),t._v(" from sklearn.neural_network import MLPRegressor, MLPClassifier"),r("br"),t._v(" from sklearn.cross_decomposition import PLSRegression"),r("br"),t._v(" from sklearn.compose import TransformedTargetRegressor"),r("br"),t._v(" import torch"),r("br"),t._v(" import torch.nn as nn"),r("br"),t._v(" from torch.autograd import Variable"),r("br"),t._v(" import torch.optim as optim"),r("br"),t._v(" import torch.nn.functional as F"),r("br"),t._v(" from torch.utils.data import TensorDataset, DataLoader, Dataset"),r("br"),t._v(" import argparse"),r("br"),t._v(" import keras"),r("br"),t._v(" import tensorflow as tf"),r("br"),t._v(" from keras import optimizers"),r("br"),t._v(" from keras.models import Sequential"),r("br"),t._v(" from keras.layers import Dense, LSTM, TimeDistributed, RepeatVector"),r("br"),r("br"),t._v(" from functools import partial"),r("br"),r("br"),t._v(" import os"),r("br"),t._v(" import dataframe_image as dfi"),r("br")]),r("div",{staticClass:"typography-line"},[r("p",[t._v("다음은 코드의 입력과 출력이다. 입력은 왠만하면 숨겨놓도록 하겠다.")])]),r("send-code",{attrs:{number:"2"}},[t._v(" data_dir = 'E:/seoulbike/data/'"),r("br"),t._v(" share_spot = pd.read_csv(data_dir + '대여소\\대여소정보.csv', engine='python',encoding='CP949', index_col=0)"),r("br"),t._v(" share_spot.info()"),r("br")]),r("receiveCode",[t._v(" Int64Index: 2653 entries, 102 to 5855"),r("br"),t._v(" Data columns (total 9 columns):"),r("br"),t._v(" # Column Non-Null Count Dtype "),r("br"),t._v(" --- ------ -------------- ----- "),r("br"),t._v(" 0 보관소(대여소)명 2653 non-null object "),r("br"),t._v(" 1 자치구 2653 non-null object "),r("br"),t._v(" 2 상세주소 2653 non-null object "),r("br"),t._v(" 3 위도 2653 non-null float64"),r("br"),t._v(" 4 경도 2653 non-null float64"),r("br"),t._v(" 5 설치시기 2652 non-null object "),r("br"),t._v(" 6 LCD 1290 non-null float64"),r("br"),t._v(" 7 QR 1355 non-null float64"),r("br"),t._v(" 8 운영방식 2629 non-null object "),r("br"),t._v(" dtypes: float64(4), object(5)"),r("br"),t._v(" memory usage: 207.3+ KB"),r("br")])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-001",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},bea5:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("send-code",{attrs:{number:"18"}},[t._v(" spot_date.loc[spot_date['대여일자']<'2018-07-05', '대여일자'] = '2018-01-01'"),r("br"),t._v(" spot_date.columns = ['번호', '대여소신설일']"),r("br"),t._v(" share_spot = pd.merge(left=share_spot, right=spot_date, how='left', left_on = '대여소번호', right_on = '번호').drop(['index','번호','연','월','일'], axis=1)"),r("br"),r("br"),t._v(" daily_use = pd.merge(left=daily_use, right=spot_date, left_on = '번호', right_on='번호')"),r("br"),t._v(" daily_use['대여일자'] = pd.to_datetime(daily_use['대여일자'])"),r("br"),t._v(" daily_use['대여소신설일'] = pd.to_datetime(daily_use['대여소신설일'])"),r("br"),t._v(" daily_use['경과일'] = (daily_use['대여일자'] - daily_use['대여소신설일'])"),r("br"),r("br"),t._v(" day_spot_df = daily_use.groupby(['대여일자','번호']).sum().reset_index().loc[:,['대여일자', '번호', '이용건수']]"),r("br"),t._v(" day_spot_df = pd.merge(left=day_spot_df, right=spot_date, left_on = '번호', right_on='번호')"),r("br"),t._v(" day_spot_df['대여소신설일'] = pd.to_datetime(day_spot_df['대여소신설일'])"),r("br"),t._v(" day_spot_df['경과일'] = (day_spot_df['대여일자'] - day_spot_df['대여소신설일'])"),r("br"),t._v(" day_spot_df['경과일'] = day_spot_df['경과일'].dt.days"),r("br"),r("br"),t._v(" stats.spearmanr(day_spot_df['이용건수'],day_spot_df['경과일'])"),r("br"),r("br"),r("br")]),r("recieve-code",[t._v(" SpearmanrResult(correlation=0.14838047761597012, pvalue=0.0) ")]),r("div",{staticClass:"typography-line"},[r("p",[r("strong",[t._v(" 귀무가설 : 이용건수와 경과일의 상관계수는 0이다. "),r("br"),t._v(" 대립가설 : 이용건수와 경과일은 상관계수는 0이 아니다."),r("br"),r("br")]),t._v(" pvaule는 0.0으로 상관관계가 있다는 것이 드러났다. 다만 0.15의 상관계수는 매우 작은데, 단조성만 유지하면 되므로 정규화가 쉽다는 점을 고려하여 우선은 모델을 만들때 포함시키도록 하자 우선은 이정도로 하고 본격적인 로그데이터 분석에 들어가도록 하자. ")])]),r("div",{staticClass:"typography-line"},[r("hr"),r("h3",[t._v("로그 데이터 톺아보기")])]),r("send-code",{attrs:{number:"19"}},[t._v(" log_data2019 = getAllCsvDask('로그/2019년',dtype={'대여거치대': 'object',"),r("br"),t._v("        '반납대여소번호': 'object',"),r("br"),t._v("        '이용거리': 'float64', '이용시간': 'float64'}"),r("br"),t._v(" )"),r("br"),t._v(" log_data2020 = getAllCsvDask('로그/2020년',dtype={'대여거치대': 'object',"),r("br"),t._v("        '반납대여소번호': 'object',"),r("br"),t._v("        '이용거리': 'float64', '이용시간': 'float64'}"),r("br"),t._v(" )"),r("br"),t._v(" log_data2021 = getAllCsvDask('로그/2021년',dtype={'대여거치대': 'object',"),r("br"),t._v("        '반납대여소번호': 'object',"),r("br"),t._v("        '이용거리': 'float64', '이용시간': 'float64'}"),r("br"),t._v(" )"),r("br"),t._v(" log_data2022 = getAllCsvDask('로그/2022년',dtype={'대여거치대': 'object',"),r("br"),t._v("        '반납대여소번호': 'object',"),r("br"),t._v("        '이용거리': 'float64', '이용시간': 'float64'}"),r("br"),t._v(" )"),r("br"),r("br"),t._v(" for i in range(len(log_data2019)):"),r("br"),t._v("     log_data2019[i].columns = ['자전거번호', '대여일시', '대여대여소번호', '대여대여소명', '대여거치대','반납일시','반납대여소번호', '반납대여소명', '반납거치대','이용시간', '이용거리']"),r("br"),t._v(" log_data2019 = pd.concat(log_data2019)"),r("br"),t._v(" for i in range(len(log_data2020)):"),r("br"),t._v("     log_data2020[i].columns = ['자전거번호', '대여일시', '대여대여소번호', '대여대여소명', '대여거치대','반납일시','반납대여소번호', '반납대여소명', '반납거치대','이용시간', '이용거리']"),r("br"),t._v(" log_data2020 = pd.concat(log_data2020)"),r("br"),t._v(" for i in range(len(log_data2021)):"),r("br"),t._v("     log_data2021[i].columns = ['자전거번호', '대여일시', '대여대여소번호', '대여대여소명', '대여거치대','반납일시','반납대여소번호', '반납대여소명', '반납거치대','이용시간', '이용거리']"),r("br"),t._v(" log_data2021 = pd.concat(log_data2021)"),r("br"),t._v(" for i in range(len(log_data2022)):"),r("br"),t._v("     log_data2022[i].columns = ['자전거번호', '대여일시', '대여대여소번호', '대여대여소명', '대여거치대','반납일시','반납대여소번호', '반납대여소명', '반납거치대','이용시간', '이용거리']"),r("br"),t._v(" log_data2022 = pd.concat(log_data2022)"),r("br"),r("br"),t._v(" log_data2019 = log_data2019.reset_index().drop('index', axis=1)"),r("br"),t._v(" log_data2020 = log_data2020.reset_index().drop('index', axis=1)"),r("br"),t._v(" log_data2021 = log_data2021.reset_index().drop('index', axis=1)"),r("br"),t._v(" log_data2022 = log_data2022.reset_index().drop('index', axis=1)"),r("br"),r("br"),t._v(" #망가진 컬럼 복구"),r("br"),t._v(" broken_index = log_data2019[log_data2019['대여거치대'].astype(str).str.len() >4].index"),r("br"),t._v(" log_data2019.loc[broken_index, '이용거리'] = log_data2019.loc[broken_index, '이용시간']"),r("br"),t._v(" log_data2019.loc[broken_index, '이용시간'] = log_data2019.loc[broken_index, '반납거치대']"),r("br"),t._v(" log_data2019.loc[broken_index, '반납거치대'] = log_data2019.loc[broken_index, '반납대여소명']"),r("br"),t._v(" log_data2019.loc[broken_index, '반납대여소명'] = log_data2019.loc[broken_index, '반납대여소번호']"),r("br"),t._v(" log_data2019.loc[broken_index, '반납대여소번호'] = log_data2019.loc[broken_index, '반납일시']"),r("br"),t._v(" log_data2019.loc[broken_index, '반납일시'] = log_data2019.loc[broken_index, '대여거치대']"),r("br"),t._v(" broken_index = log_data2020[log_data2020['대여거치대'].astype(str).str.len() >4].index"),r("br"),t._v(" log_data2020.loc[broken_index, '이용거리'] = log_data2020.loc[broken_index, '이용시간']"),r("br"),t._v(" log_data2020.loc[broken_index, '이용시간'] = log_data2020.loc[broken_index, '반납거치대']"),r("br"),t._v(" log_data2020.loc[broken_index, '반납거치대'] = log_data2020.loc[broken_index, '반납대여소명']"),r("br"),t._v(" log_data2020.loc[broken_index, '반납대여소명'] = log_data2020.loc[broken_index, '반납대여소번호']"),r("br"),t._v(" log_data2020.loc[broken_index, '반납대여소번호'] = log_data2020.loc[broken_index, '반납일시']"),r("br"),t._v(" log_data2020.loc[broken_index, '반납일시'] = log_data2020.loc[broken_index, '대여거치대']"),r("br"),t._v(" broken_index = log_data2021[log_data2021['대여거치대'].astype(str).str.len() >4].index"),r("br"),t._v(" log_data2021.loc[broken_index, '이용거리'] = log_data2021.loc[broken_index, '이용시간']"),r("br"),t._v(" log_data2021.loc[broken_index, '이용시간'] = log_data2021.loc[broken_index, '반납거치대']"),r("br"),t._v(" log_data2021.loc[broken_index, '반납거치대'] = log_data2021.loc[broken_index, '반납대여소명']"),r("br"),t._v(" log_data2021.loc[broken_index, '반납대여소명'] = log_data2021.loc[broken_index, '반납대여소번호']"),r("br"),t._v(" log_data2021.loc[broken_index, '반납대여소번호'] = log_data2021.loc[broken_index, '반납일시']"),r("br"),t._v(" log_data2021.loc[broken_index, '반납일시'] = log_data2021.loc[broken_index, '대여거치대']"),r("br"),t._v(" broken_index = log_data2022[log_data2021['대여거치대'].astype(str).str.len() >4].index"),r("br"),r("br"),t._v(" log_data2019.drop(['대여대여소명','반납대여소명','대여거치대','반납거치대'], axis=1, inplace=True)"),r("br"),t._v(" log_data2020.drop(['대여대여소명','반납대여소명','대여거치대','반납거치대'], axis=1, inplace=True)"),r("br"),t._v(" log_data2021.drop(['대여대여소명','반납대여소명','대여거치대','반납거치대'], axis=1, inplace=True)"),r("br"),t._v(" log_data2022.drop(['대여대여소명','반납대여소명','대여거치대','반납거치대'], axis=1, inplace=True)"),r("br"),r("br"),t._v(" #행의 타입을 지정"),r("br"),t._v(" log_data2019['반납대여소번호'] = log_data2019['반납대여소번호'].astype(int)"),r("br"),t._v(" log_data2022['반납대여소번호'] = log_data2022['반납대여소번호'].astype(int)"),r("br"),t._v(" log_data2020['반납대여소번호'] = log_data2020['반납대여소번호'].astype(int)"),r("br"),t._v(" log_data2021['반납대여소번호'] = log_data2021['반납대여소번호'].astype(int)"),r("br"),r("br"),t._v(" log_data2022['대여일시'] = pd.to_datetime(log_data2022['대여일시'], format='%Y-%m-%d %H:%M')"),r("br"),t._v(" log_data2022['반납일시'] = pd.to_datetime(log_data2022['반납일시'], format='%Y-%m-%d %H:%M')"),r("br"),t._v(" log_data2021['대여일시'] = pd.to_datetime(log_data2021['대여일시'], format='%Y-%m-%d %H:%M')"),r("br"),t._v(" log_data2021['반납일시'] = pd.to_datetime(log_data2021['반납일시'], format='%Y-%m-%d %H:%M')"),r("br"),t._v(" log_data2020['대여일시'] = pd.to_datetime(log_data2020['대여일시'], format='%Y-%m-%d %H:%M')"),r("br"),t._v(" log_data2020['반납일시'] = pd.to_datetime(log_data2020['반납일시'], format='%Y-%m-%d %H:%M')"),r("br"),t._v(" log_data2019['대여일시'] = pd.to_datetime(log_data2019['대여일시'], format='%Y-%m-%d %H:%M')"),r("br"),t._v(" log_data2019['반납일시'] = pd.to_datetime(log_data2019['반납일시'], format='%Y-%m-%d %H:%M')"),r("br"),t._v(" log_data2022['자전거번호'].str.contains('SPB').value_counts() #전부 SPB이 붙어있으므로 SPB제거"),r("br"),t._v(" log_data2019['자전거번호'] = log_data2019['자전거번호'].str.slice(4).astype(int)"),r("br"),t._v(" log_data2020['자전거번호'] = log_data2020['자전거번호'].str.slice(4).astype(int)"),r("br"),t._v(" log_data2021['자전거번호'] = log_data2021['자전거번호'].str.slice(4).astype(int)"),r("br"),t._v(" log_data2022['자전거번호'] = log_data2022['자전거번호'].str.slice(4).astype(int)"),r("br"),r("br"),t._v(" log_data2020.head()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("img",{staticClass:"frame",attrs:{src:"http://localhost:8000/static/figures/log_data_2020_before.png"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 데이터가 너무 많아 19.1월부터 22.6월까지의 데이터만 이용하기로 했다. 열이 너무 많아서 각 년도별로 따로 실행하지 않으면 렉이 걸리거나 심지어는 커널이 죽어버려서 따로따로 실행했다."),r("br"),r("br"),t._v(" 이용거리가 0미터로 잡히는 경우는 결측치로 보고 처리해야하지만 우선 그 이전에 자전거가 대여소에서 다른 대여소로 이동하는 이력이 모두 잡히는지 확인해본다. 만약에 자전거가 한 곳에서 다른 곳으로 이동하는 모든 때가 기록이 되어있다면, 자전거의 유입, 유출량 뿐 아니라 대여소별 최저치를 0으로 삼아 각 시간마다의 자전거 보유 대수를 손쉽게 알아낼 수 있을 것이다."),r("br"),r("br"),t._v(" 확인방식은 시간순으로 정렬된 로그에서 특정 번호의 자전거를 빌릴 때 이전에 반납했던 위치에 그대로 있었는지 확인하는 식이다. 그러나 예상하건대, 트럭으로 옮기거나 정비가는 경우가 있어서 갑자기 자전거의 위치가 점프하는 경우가 있을 것이다. 그 비율이 높지 않기를 바래본다. ")])]),r("send-code",{attrs:{number:"20"}},[t._v(" check_data = log_data2020.sort_values('대여일시')"),r("br"),t._v(" num_error = 0"),r("br"),t._v(" location = [0 for i in range(100000)]"),r("br"),t._v(" for bicycle_num, start_location, end_location in zip(check_data['자전거번호'], check_data['대여대여소번호'], check_data['반납대여소번호']):"),r("br"),t._v("     if location[bicycle_num] != start_location and location[bicycle_num] != 0:"),r("br"),t._v("         num_error += 1"),r("br"),t._v("     location[bicycle_num] = end_location"),r("br"),t._v(" print('에러율  :', num_error/len(check_data['자전거번호'])*100, '%')"),r("br")]),r("recieve-code",[t._v(" 에러율 : 5.145014599793885 % ")]),r("div",{staticClass:"typography-line"},[r("p",[t._v(" 에러율이 너무 높아서 자전거의 이력으로부터 대여소의 자전거 개수를 파악하려는 시도는 사실상 반려된다. 따라서 더 이상 미련을 두지 않고, 이상치를 전부 제거했다. ")])]),r("send-code",{attrs:{number:"21"}},[t._v(" log_data2019 = log_data2019[(log_data2019['이용시간']>0) & ((log_data2019['이용거리'])<100000) & ((log_data2019['이용거리']/log_data2019['이용시간'])<700) & ((log_data2019['이용시간'])<240)]"),r("br"),t._v(" log_data2019 = log_data2019[(log_data2019['대여대여소번호'] < 9000) & (log_data2019['대여대여소번호'] > 100) & (log_data2019['반납대여소번호'] < 9000) & (log_data2019['반납대여소번호'] > 100)]"),r("br"),t._v(" log_data2020 = log_data2020[(log_data2020['이용시간']>0) & ((log_data2020['이용거리'])<100000) & ((log_data2020['이용거리']/log_data2020['이용시간'])<700) & ((log_data2020['이용시간'])<240)]"),r("br"),t._v(" log_data2020 = log_data2020[(log_data2020['대여대여소번호'] < 9000) & (log_data2020['대여대여소번호'] > 100) & (log_data2020['반납대여소번호'] < 9000) & (log_data2020['반납대여소번호'] > 100)]"),r("br"),t._v(" log_data2021 = log_data2021[(log_data2021['이용시간']>0) & (log_data2021['이용거리'] > 0.01) & ((log_data2021['이용거리'])<100000) & ((log_data2021['이용거리']/log_data2021['이용시간'])<700) & ((log_data2021['이용시간'])<240)]"),r("br"),t._v(" log_data2021 = log_data2021[(log_data2021['대여대여소번호'] < 9000) & (log_data2021['대여대여소번호'] > 100) & (log_data2021['반납대여소번호'] < 9000) & (log_data2021['반납대여소번호'] > 100)]"),r("br"),t._v(" log_data2022 = log_data2022[(log_data2022['이용시간']>0) & (log_data2022['이용거리'] > 0.01) & ((log_data2022['이용거리'])<100000) & ((log_data2022['이용거리']/log_data2022['이용시간'])<700) & ((log_data2022['이용시간'])<240)]"),r("br"),t._v(" log_data2022 = log_data2022[(log_data2022['대여대여소번호'] < 9000) & (log_data2022['대여대여소번호'] > 100) & (log_data2022['반납대여소번호'] < 9000) & (log_data2022['반납대여소번호'] > 100)]"),r("br"),r("br"),t._v(" log_data2019['대여일시'] = pd.to_datetime(log_data2019['대여일시'])"),r("br"),t._v(" log_data2019['반납일시'] = pd.to_datetime(log_data2019['반납일시'])"),r("br"),t._v(" log_data2020['대여일시'] = pd.to_datetime(log_data2020['대여일시'])"),r("br"),t._v(" log_data2020['반납일시'] = pd.to_datetime(log_data2020['반납일시'])"),r("br"),t._v(" log_data2021['대여일시'] = pd.to_datetime(log_data2021['대여일시'])"),r("br"),t._v(" log_data2021['반납일시'] = pd.to_datetime(log_data2021['반납일시'])"),r("br"),t._v(" log_data2022['대여일시'] = pd.to_datetime(log_data2022['대여일시'])"),r("br"),t._v(" log_data2022['반납일시'] = pd.to_datetime(log_data2022['반납일시'])"),r("br")]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 이상치를 제거한 기준은 다음과 같다."),r("br"),r("br"),t._v(" 이용시간 : 0분 초과, 4시간 미만(2시간이 이용권 최대 시간이므로) "),r("br"),t._v(" 이용거리 : 0m 초과, 100km 미만"),r("br"),t._v(" 속도 : 42km/h미만"),r("br"),t._v(" 대여소번호 : 100이하 또는 9000이상 제외"),r("br"),r("br"),t._v(" 다만 2020년 자료는 이용거리가 0m로 나오는 자료가 전체의 60퍼센트이므로 로그데이터는 그대로 유지하되 이용시간 분석에서 제외했다. ")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-005",components:{sendCode:o["a"],receiveCode:i["a"],RecieveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},c2db:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("div",{staticClass:"typography-line"},[r("p",[t._v("아래의 코드들은 개인적으로 사용하기 위해 만들어둔 함수들이다. 어떤 함수가 어떤 목적으로 작성되었는지는 전혀 몰라도 상관이 없다. 우리가 관심있는 것은 그저 어떤 분석을 했느냐에 다름아니니 말이다. 따라서 전혀보지 않아도 좋다. ")])]),r("div",{staticClass:"typography-line"},[r("p",[t._v("plotly 모듈을 이용하여 그래프를 그리기 위해 작성한 함수들이다. 그러나 축의 제목, 범위, 겹쳐그리기 등 커스터마이징 해야하는 부분이 너무 많아 나중에는 잘 사용하지 않았다. ")])]),r("send-code",{attrs:{number:"3"}},[t._v(" def seriesPlot(series, title=None, order=None, orderArray=None,color=False, colorScale = None, marker_color=False):"),r("br"),t._v("     if isinstance(orderArray, list):"),r("br"),t._v("         order = 'array'"),r("br"),t._v("     layoutVal ={'categoryorder':order, 'categoryarray' : orderArray}"),r("br"),t._v("     if color:"),r("br"),t._v("         colorVal = series.name"),r("br"),t._v("     else:"),r("br"),t._v("         colorVal = None"),r("br"),t._v("     fig = px.bar(series, y=series.name, x=series.index, color=colorVal, title=title, color_continuous_scale=colorScale)"),r("br"),t._v("     fig.update_layout(title_x=0.5, xaxis=layoutVal)"),r("br"),t._v("     fig['layout']['title']['font'] = dict(size=26)"),r("br"),t._v("     if marker_color:"),r("br"),t._v("         fig.update_traces(marker_color=['hsl('+str(h)+',50%'+',50%)' for h in np.linspace(0, 360, series.size)])"),r("br"),t._v("     return fig"),r("br"),r("br"),t._v(" def dfPlot(df,x, y, title=None, order=None, orderArray=None ,color=False, colorScale = None, autoText = False):"),r("br"),t._v("     if isinstance(orderArray, list):"),r("br"),t._v("         order = 'array'"),r("br"),t._v("     layoutVal ={'categoryorder':order, 'categoryarray' : orderArray}"),r("br"),t._v("     colorVal = None"),r("br"),t._v("     if isinstance(y, list) and len(y)>1:"),r("br"),t._v("         if color:"),r("br"),t._v("             colorVal = df.y"),r("br"),t._v("         fig = go.Figure(data=["),r("br"),t._v("         go.Bar(name=y[i], x=x, y=df[y[i]], marker_color = colorScale[i] if colorScale else None) for i in range(len(y))"),r("br"),t._v("         ])"),r("br"),t._v("         fig.update_layout(barmode='group')"),r("br"),t._v("     else:"),r("br"),t._v("         if color:"),r("br"),t._v("             colorVal = y"),r("br"),t._v("         fig = px.bar(df,x=x, y=y, color=colorVal, color_continuous_scale=colorScale, text_auto=autoText)"),r("br"),t._v("     fig.update_layout(title_x=0.5, title=title, xaxis=layoutVal)"),r("br"),t._v("     fig['layout']['title']['font'] = dict(size=26)"),r("br"),t._v("     return fig"),r("br"),r("br"),t._v(" def heatMapMap(x, y):"),r("br"),t._v("     m = folium.Map(location=(37.5776087830657, 126.976896737645), zoom_start=11)"),r("br"),t._v("    "),r("br"),t._v("     heatMap = HeatMap(zip(x, y),"),r("br"),t._v("                    min_opacity=0.1,"),r("br"),t._v("                    max_val=5,"),r("br"),t._v("                    radius=10, blur=10,"),r("br"),t._v("                    max_zoom=5,color='red')"),r("br"),r("br"),t._v("     m.add_child(heatMap)"),r("br"),t._v("     return m"),r("br"),r("br"),t._v(" def TimeSeriesPlot(df, freq, period, y, title=None, palette=True):"),r("br"),t._v("     fig = go.Figure()"),r("br"),t._v("     if palette:"),r("br"),t._v("         palette = px.colors.sequential.Sunsetdark"),r("br"),t._v("     else:"),r("br"),t._v("         palette = px.colors.sequential.Aggrnyl + px.colors.sequential.Agsunset + px.colors.sequential.algae + px.colors.sequential.amp + px.colors.sequential.Blackbody + px.colors.sequential.Bluered + px.colors.sequential.Blugrn + px.colors.sequential.Bluyl"),r("br"),t._v("     index = 0"),r("br"),t._v("     for window in plotdf[freq].unique():"),r("br"),t._v("         table= df.groupby(freq).get_group(window)"),r("br"),t._v("         fig.add_trace(go.Scatter(x=table[period], y=table[y], name=window, line=dict(color=palette[index], width=4)))"),r("br"),t._v("         index +=1"),r("br"),r("br"),t._v("     fig.update_layout(title=title,"),r("br"),t._v("     xaxis_title=period,"),r("br"),t._v("     yaxis_title=y)"),r("br"),t._v("     return fig"),r("br"),r("br"),t._v(" def HorizontalPortionBar(top_labels,x_data, y_data, colors=None, title=None):"),r("br"),t._v("     if not isinstance(colors, list):"),r("br"),t._v("         colors = px.colors.sequential.Sunsetdark"),r("br"),t._v("     x_data = [i/i.sum()*100 for i in x_data]"),r("br"),t._v("     x_data = [i.round(decimals=2) for i in x_data]"),r("br"),t._v("     fig = go.Figure()"),r("br"),r("br"),t._v("     for i in range(0, len(x_data[0])):"),r("br"),t._v("         for xd, yd in zip(x_data, y_data):"),r("br"),t._v("             fig.add_trace(go.Bar("),r("br"),t._v("                 x=[xd[i]], y=[yd],"),r("br"),t._v("                 orientation='h',"),r("br"),t._v("                 marker=dict("),r("br"),t._v("                     color=colors[i],"),r("br"),t._v("                     line=dict(color='rgb(248, 248, 249)', width=1)"),r("br"),t._v("                 )"),r("br"),t._v("             ))"),r("br"),r("br"),t._v("     fig.update_layout("),r("br"),t._v("         title=title,"),r("br"),t._v("         xaxis=dict("),r("br"),t._v("             showgrid=False,"),r("br"),t._v("             showline=False,"),r("br"),t._v("             showticklabels=False,"),r("br"),t._v("             zeroline=False,"),r("br"),t._v("             domain=[0.15, 1]"),r("br"),t._v("         ),"),r("br"),t._v("         yaxis=dict("),r("br"),t._v("             showgrid=False,"),r("br"),t._v("             showline=False,"),r("br"),t._v("             showticklabels=False,"),r("br"),t._v("             zeroline=False,"),r("br"),t._v("         ),"),r("br"),t._v("         barmode='stack',"),r("br"),t._v("         paper_bgcolor='rgb(248, 248, 255)',"),r("br"),t._v("         plot_bgcolor='rgb(248, 248, 255)',"),r("br"),t._v("         margin=dict(l=120, r=10, t=140, b=80),"),r("br"),t._v("         showlegend=False,"),r("br"),t._v("     )"),r("br"),r("br"),t._v("     annotations = []"),r("br"),r("br"),t._v("     for yd, xd in zip(y_data, x_data):"),r("br"),t._v("         # labeling the y-axis"),r("br"),t._v("         annotations.append(dict(xref='paper', yref='y',"),r("br"),t._v("                                 x=0.14, y=yd,"),r("br"),t._v("                                 xanchor='right',"),r("br"),t._v("                                 text=str(yd),"),r("br"),t._v("                                 font=dict(family='Arial', size=14,"),r("br"),t._v("                                           color='rgb(67, 67, 67)'),"),r("br"),t._v("                                 showarrow=False, align='right'))"),r("br"),t._v("         # labeling the first percentage of each bar (x_axis)"),r("br"),t._v("         annotations.append(dict(xref='x', yref='y',"),r("br"),t._v("                                 x=xd[0] / 2, y=yd,"),r("br"),t._v("                                 text=str(xd[0]) + '%',"),r("br"),t._v("                                 font=dict(family='Arial', size=14,"),r("br"),t._v("                                           color='rgb(248, 248, 255)'),"),r("br"),t._v("                                 showarrow=False))"),r("br"),t._v("         # labeling the first Likert scale (on the top)"),r("br"),t._v("         if yd == y_data[-1]:"),r("br"),t._v("             annotations.append(dict(xref='x', yref='paper',"),r("br"),t._v("                                     x=xd[0] / 2, y=1.1,"),r("br"),t._v("                                     text=top_labels[0],"),r("br"),t._v("                                     font=dict(family='Arial', size=14,"),r("br"),t._v("                                               color='rgb(67, 67, 67)'),"),r("br"),t._v("                                     showarrow=False))"),r("br"),t._v("         space = xd[0]"),r("br"),t._v("         for i in range(1, len(xd)):"),r("br"),t._v("                 # labeling the rest of percentages for each bar (x_axis)"),r("br"),t._v("                 annotations.append(dict(xref='x', yref='y',"),r("br"),t._v("                                         x=space + (xd[i]/2), y=yd,"),r("br"),t._v("                                         text=str(xd[i]) + '%',"),r("br"),t._v("                                         font=dict(family='Arial', size=14,"),r("br"),t._v("                                                   color='rgb(248, 248, 255)'),"),r("br"),t._v("                                         showarrow=False))"),r("br"),t._v("                 # labeling the Likert scale"),r("br"),t._v("                 if yd == y_data[-1]:"),r("br"),t._v("                     annotations.append(dict(xref='x', yref='paper',"),r("br"),t._v("                                             x=space + (xd[i]/2), y=1.1,"),r("br"),t._v("                                             text=top_labels[i],"),r("br"),t._v("                                             font=dict(family='Arial', size=14,"),r("br"),t._v("                                                       color='rgb(67, 67, 67)'),"),r("br"),t._v("                                             showarrow=False))"),r("br"),t._v("                 space += xd[i]"),r("br"),r("br"),t._v("     fig.update_layout(annotations=annotations)"),r("br"),t._v("     return fig"),r("br"),r("br"),t._v(" def pivotToTimeplot(timeplotdf, title=None, yaxis = None, yRange=None, order = False, duration=500):"),r("br"),t._v("     variables = timeplotdf.index"),r("br"),t._v("     N=len(timeplotdf.columns)"),r("br"),t._v("     colorPalette = pd.Series(['hsl('+str(h)+',50%'+',50%)' for h in np.linspace(0, 360, N)], index=timeplotdf.iloc[-1].sort_values(ascending = False).index)"),r("br"),t._v("     if order:"),r("br"),t._v("        colorPalette = colorPalette.loc[timplotdf.columns]"),r("br"),t._v("     timeplotdf.iloc[-1].sort_values(ascending = False)"),r("br"),r("br"),t._v("     columnOrder = timeplotdf.iloc[-1].sort_values(ascending = False).index if order else None;"),r("br"),r("br"),t._v("     fig_dict = {"),r("br"),t._v('         "data": [],'),r("br"),t._v('         "layout": {},'),r("br"),t._v('         "frames": []'),r("br"),t._v("     }"),r("br"),t._v('     fig_dict["layout"]["xaxis"] = {"title": timeplotdf.columns.name}'),r("br"),t._v('     fig_dict["layout"]["yaxis"] = {"title": yaxis, "range": yRange}'),r("br"),t._v('     fig_dict["layout"]["hovermode"] = "closest"'),r("br"),t._v('     fig_dict["layout"]["updatemenus"] = ['),r("br"),t._v("         {"),r("br"),t._v('             "buttons": ['),r("br"),t._v("                 {"),r("br"),t._v('                     "args": [None, {"frame": {"duration": duration, "redraw": False},'),r("br"),t._v('                                     "fromcurrent": True, "transition": {"duration": duration,'),r("br"),t._v('                                                                         "easing": "quadratic-in-out"}}],'),r("br"),t._v('                     "label": "Play",'),r("br"),t._v('                     "method": "animate"'),r("br"),t._v("                 },"),r("br"),t._v("                 {"),r("br"),t._v('                     "args": [[None], {"frame": {"duration": 0, "redraw": False},'),r("br"),t._v('                                       "mode": "immediate",'),r("br"),t._v('                                       "transition": {"duration": 0}}],'),r("br"),t._v('                     "label": "Pause",'),r("br"),t._v('                     "method": "animate"'),r("br"),t._v("                 }"),r("br"),t._v("             ],"),r("br"),t._v('             "direction": "left",'),r("br"),t._v('             "pad": {"r": 10, "t": 87},'),r("br"),t._v('             "showactive": False,'),r("br"),t._v('             "type": "buttons",'),r("br"),t._v('             "x": 0.1,'),r("br"),t._v('             "xanchor": "right",'),r("br"),t._v('             "y": 0,'),r("br"),t._v('             "yanchor": "top"'),r("br"),t._v("         }"),r("br"),t._v("     ]"),r("br"),t._v("     sliders_dict = {"),r("br"),t._v('         "active": 0,'),r("br"),t._v('         "yanchor": "top",'),r("br"),t._v('         "xanchor": "left",'),r("br"),t._v('         "currentvalue": {'),r("br"),t._v('             "font": {"size": 20},'),r("br"),t._v('             "prefix": timeplotdf.index.name+":",'),r("br"),t._v('             "visible": True,'),r("br"),t._v('             "xanchor": "right"'),r("br"),t._v("         },"),r("br"),t._v('         "transition": {"duration": duration, "easing": "cubic-in-out"},'),r("br"),t._v('         "pad": {"b": 10, "t": 50},'),r("br"),t._v('         "len": 0.9,'),r("br"),t._v('         "x": 0.1,'),r("br"),t._v('         "y": 0,'),r("br"),t._v('         "steps": []'),r("br"),t._v("     }"),r("br"),r("br"),t._v("     variable = variables[0]"),r("br"),t._v("     data = go.Bar(x=timeplotdf.columns, y=timeplotdf.loc[variable], marker_color=colorPalette)"),r("br"),t._v("     data_dict = {"),r("br"),t._v('         "x": timeplotdf.columns,'),r("br"),t._v('         "y": timeplotdf.loc[variable]'),r("br"),t._v("     }"),r("br"),t._v('     fig_dict["data"].append(data)'),r("br"),r("br"),r("br"),t._v("     for variable in variables:"),r("br"),t._v('         frame = {"data": [], "name": str(variable)}'),r("br"),t._v("         data = go.Bar(x=timeplotdf.columns, y=timeplotdf.loc[variable])"),r("br"),t._v("         data_dict = {"),r("br"),t._v('         "x": timeplotdf.columns,'),r("br"),t._v('         "y": timeplotdf.loc[variable],'),r("br"),t._v("         }"),r("br"),t._v('         frame["data"].append(data)'),r("br"),r("br"),t._v('         fig_dict["frames"].append(frame)'),r("br"),t._v('         slider_step = {"args": ['),r("br"),t._v("             [variable],"),r("br"),t._v('             {"frame": {"duration": duration, "redraw": False},'),r("br"),t._v('              "mode": "immediate",'),r("br"),t._v('              "transition": {"duration": duration}}'),r("br"),t._v("         ],"),r("br"),t._v('             "label": variable,'),r("br"),t._v('             "method": "animate"}'),r("br"),t._v('         sliders_dict["steps"].append(slider_step)'),r("br"),r("br"),t._v('     fig_dict["layout"]["sliders"] = [sliders_dict]'),r("br"),t._v("     fig_dict['layout']['title'] = title"),r("br"),t._v("     fig_dict['layout']['xaxis']['categoryorder'] = 'array'"),r("br"),t._v("     fig_dict['layout']['xaxis']['categoryarray'] = columnOrder"),r("br"),r("br"),t._v("     fig = go.Figure(fig_dict)"),r("br"),t._v("     return fig"),r("br"),r("br"),r("br"),t._v(" def pxMerger(figs, rows, cols):"),r("br"),t._v("     fig = make_subplots(rows=rows, cols=cols, shared_xaxes=False)"),r("br"),t._v("     N = rows*cols"),r("br"),t._v("     for i in range(min(N, len(figs))):"),r("br"),t._v("         fig.add_trace(figs[i]['data'][0], row=i//cols+1, col=i%cols+1)"),r("br"),t._v("     fig.update_layout(   "),r("br"),t._v("     width=400*cols+500,"),r("br"),t._v("     height = 300*rows+300)"),r("br"),t._v("     return fig"),r("br"),r("br"),t._v(" def errorIntepreter(errors, models, trialset, draw='RMSLE', log=False, parameter='alpha', title=None, compare=None):"),r("br"),t._v("     figs = []"),r("br"),t._v("     for i in range(len(models)):"),r("br"),t._v("         model_error = pd.DataFrame(errors[models[i]], columns=['RMSLE', 'RMSE', 'MAE'], index=trialset)"),r("br"),t._v("         figs.append(px.line(model_error, x=model_error.index, y=draw, log_x=log))"),r("br"),t._v("     fig = pxMerger(figs, len(models), 1)"),r("br"),t._v("     for i in range(len(models)):"),r("br"),t._v("         fig.update_yaxes(title_text=models[i]().__class__.__name__, row=i+1, col=1)"),r("br"),t._v("         if log:"),r("br"),t._v('             fig.update_xaxes(type="log", row=1+i, col=1)'),r("br"),t._v("     if log:"),r("br"),t._v('         fig.update_xaxes(title_text=parameter, type="log", row=len(models), col=1)'),r("br"),t._v("     else:"),r("br"),t._v("         fig.update_xaxes(title_text=parameter, row=len(models), col=1)"),r("br"),t._v("     fig.update_layout(title_text=title)"),r("br"),t._v("     if isinstance(compare, float) or isinstance(compare, int):"),r("br"),t._v("         shapes = [{'type' : \"line\",'x0' : min(trialset), 'y0' : compare, 'x1' : max(trialset), 'y1': compare,'line' : {'color' : \"Red\",\"width\":2, \"dash\":\"dashdot\"}, 'xref': 'x1', 'yref': 'y'+str(i+1)} for i in range(len(models)) ]"),r("br"),t._v("         fig['layout'].update(shapes=shapes)"),r("br"),t._v("     return fig"),r("br")]),r("div",{staticClass:"typography-line"},[r("p",[t._v("이 함수들은 모델에 대한 평가를 자동화하기 위해 만든 함수들이다. 그러나 이것들도 나중에는 잘 쓰지 않았다.")])]),r("send-code",{attrs:{number:"4"}},[t._v(" def minMaxScale(df):"),r("br"),t._v("     min_max_scaler = MinMaxScaler()"),r("br"),t._v("     min_max_scaler.fit(df)"),r("br"),t._v("     scaled_df = min_max_scaler.transform(df)"),r("br"),t._v("     scaled_df = pd.DataFrame(scaled_df, columns=df.columns, index=df.index)"),r("br"),t._v("     return scaled_df"),r("br"),r("br"),t._v(" def evaluation(y,pred):"),r("br"),t._v("     rmsle_val = np.sqrt(np.mean((np.log1p(y) - np.log1p(pred)) ** 2))"),r("br"),t._v("     rmse_val = np.sqrt(mean_squared_error(y,pred))"),r("br"),t._v("     mae_val = mean_absolute_error(y,pred)"),r("br"),t._v("     print('RMSLE: {0:.3f}, RMSE: {1:.3F}, MAE: {2:.3F}'.format(rmsle_val, rmse_val, mae_val))"),r("br"),t._v("     return rmsle_val, rmse_val, mae_val"),r("br"),t._v("    "),r("br"),t._v(" def get_top_error(y_test, pred, n_tops = 5):"),r("br"),t._v("     result_df = pd.DataFrame(y_test.values, columns=['real_count'])"),r("br"),t._v("     result_df['predicted_count']= np.round(pred)"),r("br"),t._v("     result_df['diff'] = np.abs(result_df['real_count'] - result_df['predicted_count'])"),r("br"),t._v("     print(result_df.sort_values('diff', ascending=False)[:n_tops])"),r("br"),t._v("    "),r("br"),t._v(" def model_evaluation(model, X, y, translation='', test_times=3, test_size=24*30*6, watch=False, output = 'error'):"),r("br"),t._v("     if translation=='log1p' :"),r("br"),t._v("         y = np.log1p(y)"),r("br"),t._v("     if translation=='sqrt' :"),r("br"),t._v("         y = np.sqrt(y)"),r("br"),t._v("     if translation=='cbrt' :"),r("br"),t._v("         y = np.cbrt(y)"),r("br"),t._v("     if translation=='qqrt' :"),r("br"),t._v("         y = np.sqrt(np.sqrt(y))"),r("br"),t._v("     tscv = TimeSeriesSplit(n_splits=test_times , test_size=test_size)"),r("br"),t._v("     for train_index, test_index in tscv.split(X):"),r("br"),t._v("         X_train, X_test = X.iloc[train_index], X.iloc[test_index]"),r("br"),t._v("         y_train, y_test = y.iloc[train_index], y.iloc[test_index]"),r("br"),t._v("     model.fit(X_train, y_train)"),r("br"),t._v("     pred = model.predict(X_test)"),r("br"),t._v("     if translation=='log1p' :"),r("br"),t._v("         y_test = np.expm1(y_test)"),r("br"),t._v("         pred = np.expm1(pred)"),r("br"),t._v("     if translation=='sqrt' :"),r("br"),t._v("         y_test = y_test**2"),r("br"),t._v("         pred = pred**2"),r("br"),t._v("     if translation=='cbrt' :"),r("br"),t._v("         y_test = y_test**3"),r("br"),t._v("         pred = pred**3"),r("br"),t._v("     if translation=='qqrt' :"),r("br"),t._v("         y_test = y_test**4"),r("br"),t._v("         pred = pred**4"),r("br"),t._v("     if watch:"),r("br"),t._v("         get_top_error(y_test, pred, n_tops = 5)"),r("br"),t._v("     print('###',model.__class__.__name__,'###')"),r("br"),t._v("     if output =='model':"),r("br"),t._v("         return model"),r("br"),t._v("     return evaluation(y_test, pred)"),r("br"),r("br"),t._v(" def rmsle(y, pred):"),r("br"),t._v("     return np.sqrt(np.mean((np.log1p(y) - np.log1p(pred)) ** 2))"),r("br"),r("br"),t._v(" def rmse(y,pred):"),r("br"),t._v("     return np.sqrt(mean_squared_error(y,pred))"),r("br"),r("br"),t._v(" def mae(y,pred):"),r("br"),t._v("     return mean_absolute_error(y,pred)"),r("br"),r("br")]),r("div",{staticClass:"typography-line"},[r("p",[t._v("csv파일을 읽어들이기 위해 만든 함수이다. 이 함수들은 한 번 작성된 후, 변경하지 않고 끝까지 잘 사용했다.")])]),r("send-code",{attrs:{number:"5"}},[t._v(" def getAllCsv(subDir, data_dir=data_dir):"),r("br"),t._v("     if(subDir[-1]!='/'):"),r("br"),t._v("         subDir += '/'"),r("br"),t._v("     if(subDir[0]=='/'):"),r("br"),t._v("         subDir = subDir[1:]"),r("br"),t._v("     A = []"),r("br"),t._v("     for fileName in os.listdir(data_dir+subDir):"),r("br"),t._v("         try:"),r("br"),t._v("             print(fileName)"),r("br"),t._v("             a =pd.read_csv(data_dir+subDir+fileName, encoding='cp949', index_col=0)"),r("br"),t._v("         except:"),r("br"),t._v("             print(fileName)"),r("br"),t._v("             a =pd.read_csv(data_dir+subDir+fileName, encoding='utf-8', index_col=0)"),r("br"),t._v("         A.append(a)"),r("br"),t._v("     return A"),r("br"),r("br"),t._v(" def getAllCsvDask(subDir, data_dir=data_dir, dtype=None):"),r("br"),t._v("     if(subDir[-1]!='/'):"),r("br"),t._v("         subDir += '/'"),r("br"),t._v("     if(subDir[0]=='/'):"),r("br"),t._v("         subDir = subDir[1:]"),r("br"),t._v("     A = []"),r("br"),t._v("     for fileName in os.listdir(data_dir+subDir):"),r("br"),t._v("         print(fileName)"),r("br"),t._v("         try:"),r("br"),t._v("             dask_df = dd.read_csv(data_dir+subDir+fileName, encoding='cp949', dtype=dtype)"),r("br"),t._v("             pandas_df = dask_df.compute()"),r("br"),t._v("         except:"),r("br"),t._v("             print(fileName)"),r("br"),t._v("             dask_df = dd.read_csv(data_dir+subDir+fileName, encoding='UTF-8', dtype=dtype)"),r("br"),t._v("             pandas_df = dask_df.compute()"),r("br"),t._v("         A.append(pandas_df)"),r("br"),t._v("     return A"),r("br")]),r("div",{staticClass:"typography-line"},[r("p",[t._v("머신러닝시에 데이터셋을 빌드하고 GridSearchCV를 수행할 때, 교차검증하기에는 적은 수의 데이터만을 가지고 있는 대여소들의 경우를 상정하고 만든 함수이다. ")])]),r("send-code",{attrs:{number:"6"}},[t._v(" def getSpotData(number):  #데이터 전처리과정 포함"),r("br"),t._v("     data = pd.concat([대여반납_2019[대여반납_2019['대여소']==number], 대여반납_2020[대여반납_2020['대여소']==number],"),r("br"),t._v("            대여반납_2021[대여반납_2021['대여소']==number], 대여반납_2022[대여반납_2022['대여소']==number]], ignore_index=True, axis=0)"),r("br"),t._v("     open_day = pd.to_datetime(share_spot.loc[share_spot['대여소번호']==number, '대여소신설일']).iloc[0]"),r("br"),t._v("     since_day = (pd.to_datetime(weather['일시'])-open_day).dt.days"),r("br"),t._v("     since_day.name = '경과일'"),r("br"),t._v("     weather_since = pd.concat([weather ,since_day], axis=1)"),r("br"),t._v("     data = pd.merge(left=data, right=weather_since.loc[weather_since['경과일']>=0], how='right', left_on = ['년','월','일','시'], right_on=['년','월','일','시']).drop(['일','년','월','휴일_x','시'], axis=1)"),r("br"),t._v("     data['대여횟수'] = data['대여횟수'].fillna(0)"),r("br"),t._v("     data['반납횟수'] = data['반납횟수'].fillna(0)"),r("br"),t._v("     data['대여소'] = data['대여소'].fillna(number)"),r("br"),t._v("     mms = MinMaxScaler()"),r("br"),t._v("     scaled_rows = pd.DataFrame(mms.fit_transform(data.loc[:,['기온', '풍속(m/s)','전운량(10분위)', '습도(%)', '경과일']]))"),r("br"),t._v("     data['기온'] = scaled_rows[0]"),r("br"),t._v("     data['풍속'] = scaled_rows[1]"),r("br"),t._v("     data['전운량'] = scaled_rows[2]"),r("br"),t._v("     data['습도'] = scaled_rows[3]"),r("br"),t._v("     data['경과일'] = scaled_rows[4]"),r("br"),t._v("     data['강수량'] = np.log1p(data.loc[:,['강수량(mm)']])"),r("br"),t._v("     data.drop(['풍속(m/s)','전운량(10분위)', '습도(%)', '강수량(mm)'], axis=1, inplace=True)"),r("br"),t._v("     data.columns = ['대여소','대여횟수', '반납횟수', '일시', '기온', '안개', '비 또는 눈', '연무', '휴일', '경과일', '풍속', '전운량', '습도', '강수량']"),r("br"),t._v("     data.index = pd.to_datetime(data['일시'])"),r("br"),t._v("     data['일시'] = pd.to_datetime(data['일시'])"),r("br"),t._v("     return data"),r("br"),r("br"),t._v(" class GridSearchWithoutCV:"),r("br"),t._v("     def __init__(self, estimator, param_grid , scoring):"),r("br"),t._v("         self.best_score = float('inf')"),r("br"),t._v("         self.estimator = estimator"),r("br"),t._v("         self.parameters = ParameterGrid(param_grid)"),r("br"),t._v("         sefl.scoring = scoring"),r("br"),t._v("         self.best_estimator = None"),r("br"),t._v("    "),r("br"),t._v("     def bestFit(self, x, y, test_x, test_y):"),r("br"),t._v("         for g in self.parameters:"),r("br"),t._v("             self.estimator.set_params(**g)"),r("br"),t._v("             self.estimator.fit(x, y)"),r("br"),t._v("             pred = estimator.predict(test_x)       "),r("br"),t._v("             error_val = self.scoring(test_y,pred)"),r("br"),t._v("         if error_val < best_score:"),r("br"),t._v("             best_score = error_val"),r("br"),t._v("             best_grid = g"),r("br"),t._v("         self.best_estimator = estimator.set_params(**best_grid)"),r("br"),t._v("     def best_estimator_(self):"),r("br"),t._v("         return self.best_estimator"),r("br"),t._v("    "),r("br"),t._v(" def MachineLearn(X,y, models, model_names, params, ohe=True, analysis='유출량', method=''):"),r("br"),t._v("     len_in_year = len(X)/24/365"),r("br"),t._v("     if len_in_year > 3.49:"),r("br"),t._v("         test_len = 24*6*30"),r("br"),t._v("         cross_validation_N = 4"),r("br"),t._v("     elif len_in_year > 2.99:"),r("br"),t._v("         test_len = 24*6*30"),r("br"),t._v("         cross_validation_N = 3"),r("br"),t._v("     elif len_in_year > 2.49:"),r("br"),t._v("         test_len = 24*6*30"),r("br"),t._v("         cross_validation_N = 2  "),r("br"),t._v("     elif len_in_year > 1.95:"),r("br"),t._v("         test_len = 24*4*30"),r("br"),t._v("         cross_validation_N = 3"),r("br"),t._v("     elif len_in_year > 1.6:"),r("br"),t._v("         test_len = 24*4*30"),r("br"),t._v("         cross_validation_N = 2 "),r("br"),t._v("     elif len_in_year > 1.3:"),r("br"),t._v("         test_len = int(len(X_ohe)*0.2)"),r("br"),t._v("         cross_validation_N = 1"),r("br"),t._v("     train_len = len(X)-test_len"),r("br"),t._v("     if ohe:"),r("br"),t._v("         ohe_cal = []"),r("br"),t._v("         for cal in ['년', '월','시','요일']:"),r("br"),t._v("             if cal in X.columns:"),r("br"),t._v("                 ohe_cal.append(cal)"),r("br"),t._v("         X_ohe = pd.get_dummies(X, columns=ohe_cal)"),r("br"),t._v("         X_train = X_ohe[:train_len]"),r("br"),t._v("         X_test = X_ohe[train_len:]"),r("br"),t._v("     else:"),r("br"),t._v("         X_train = X[:train_len]"),r("br"),t._v("         X_test = X[train_len:]"),r("br"),t._v("     y['유출량'] = y['대여횟수']-y['반납횟수']"),r("br"),t._v("     y_train = y[:train_len]"),r("br"),t._v("     y_test = y[train_len:]"),r("br"),t._v("     y_train_유출량 = y_train[analysis]"),r("br"),t._v("     y_test_유출량 = y_test[analysis]"),r("br"),t._v("     if method == 'cbrt':"),r("br"),t._v("         y_train_유출량 = np.cbrt(y_train_유출량)"),r("br"),t._v("         y_test_유출량 = np.cbrt(y_test_유출량)"),r("br"),t._v("     if cross_validation_N > 1:"),r("br"),t._v("         tscv = TimeSeriesSplit(n_splits=cross_validation_N, test_size=test_len)"),r("br"),t._v("    "),r("br"),t._v("     error_names = ['RMSE', 'MAE']"),r("br"),t._v("     fit_models = {}"),r("br"),t._v("     models_point = np.empty(shape=[0])"),r("br"),t._v("     best_mae = float('inf')"),r("br"),t._v("     for model_name, model in models:"),r("br"),t._v("         param_grid = params[model_name]"),r("br"),t._v("         if cross_validation_N > 1:"),r("br"),t._v('             grid = GridSearchCV(estimator=model, cv=tscv, param_grid=param_grid, scoring="neg_mean_absolute_error", verbose=10) '),r("br"),t._v("             grid = grid.fit(X_train, y_train_유출량)"),r("br"),t._v("             model = grid.best_estimator_"),r("br"),t._v("         else:"),r("br"),t._v("             grid = GridSearchWithoutCV(estimator=model, param_grid=param_grid, scoring = mae)"),r("br"),t._v("             grid = grid.fit(X_train, y_train_대여, X_test, y_test_대여)"),r("br"),t._v("             model = grid.best_estimator_"),r("br"),t._v("         pred = model.predict(X_test)"),r("br"),t._v("        "),r("br"),t._v("         if method=='cbrt':"),r("br"),t._v("             rmse_val = rmse(y_test_유출량**3,pred**3)"),r("br"),t._v("             mae_val = mean_absolute_error(y_test_유출량**3, pred**3)           "),r("br"),t._v("         else:"),r("br"),t._v("             rmse_val = rmse(y_test_유출량,pred)"),r("br"),t._v("             mae_val = mean_absolute_error(y_test_유출량, pred)"),r("br"),t._v("         if best_mae > mae_val:"),r("br"),t._v("             best_model = model"),r("br"),t._v("         fit_models[model_name] = model"),r("br"),t._v("         print(model_name)"),r("br"),t._v("         print('RMSE: {0:.3F}, MAE: {1:.3F}'.format(rmse_val, mae_val))"),r("br"),t._v("         models_point = np.concatenate((models_point, rmse_val, mae_val), axis = None)"),r("br"),t._v("     models_error = pd.DataFrame(models_point.reshape(-1,2),columns=error_names, index = model_names)"),r("br"),t._v("     best_models = fit_models"),r("br"),t._v("    "),r("br"),t._v("    "),r("br"),t._v("     best_pred = best_model.predict(X_test)"),r("br"),t._v("     if method=='cbrt':"),r("br"),t._v("         y_test_유출량 = (y_test_유출량)**3"),r("br"),t._v("         best_pred = best_pred**3"),r("br"),t._v("     pred_comparison = pd.concat([y_test_유출량.reset_index(drop=True), pd.Series(best_pred)], axis=1)"),r("br"),t._v("     pred_comparison.columns = [analysis, '예측']"),r("br"),t._v("     pred_comparison[1:40]   "),r("br"),t._v("     fig = go.Figure()"),r("br"),t._v("     fig.add_trace(go.Scatter(y=pred_comparison[1:40][analysis],"),r("br"),t._v("                     mode='lines+markers',"),r("br"),t._v("                     name=analysis))"),r("br"),t._v("     fig.add_trace(go.Scatter(y=pred_comparison[1:40]['예측'],"),r("br"),t._v("                     mode='lines',"),r("br"),t._v("                     name='예측'))"),r("br"),t._v("     fig.update_layout("),r("br"),t._v("         title_text=\"BEST 예측과 실제 \"+analysis +' '+ method,"),r("br"),t._v("         )"),r("br"),r("br"),t._v("     fig.show()"),r("br"),t._v("     return best_models, models_error, pred_comparison"),r("br"),r("br"),t._v(" def errorplot(errors, upper, lower, title, error='MAE'):"),r("br"),t._v("     fig = px.line(errors[error] , markers=True)"),r("br"),t._v("     fig.update_layout("),r("br"),t._v("         title_text=title,"),r("br"),t._v("         )"),r("br"),t._v("     fig.add_trace(go.Scatter("),r("br"),t._v("         x=errors['MAE'].index,"),r("br"),t._v("         y=[upper]*len(errors),"),r("br"),t._v("         name=\"'---' model\""),r("br"),t._v("     ))"),r("br"),t._v("     fig.add_trace(go.Scatter("),r("br"),t._v("         x=errors['MAE'].index,"),r("br"),t._v("         y=[lower]*len(errors),"),r("br"),t._v('         name="all time best"'),r("br"),t._v("     ))"),r("br"),t._v("     return fig "),r("br"),r("br"),t._v(" def getSpotData(number):"),r("br"),t._v("     data = pd.concat([대여반납_2019[대여반납_2019['대여소']==number], 대여반납_2020[대여반납_2020['대여소']==number],"),r("br"),t._v("            대여반납_2021[대여반납_2021['대여소']==number], 대여반납_2022[대여반납_2022['대여소']==number]], ignore_index=True, axis=0)"),r("br"),t._v("     open_day = pd.to_datetime(share_spot.loc[share_spot['대여소번호']==number, '대여소신설일']).iloc[0]"),r("br"),t._v("     weather['일시'] = pd.to_datetime(weather['일시'])"),r("br"),t._v("     since_day = (weather['일시']-open_day).dt.days"),r("br"),t._v("     since_day.name = '경과일'"),r("br"),t._v("     weather_since = pd.concat([weather ,since_day], axis=1)"),r("br"),t._v("     data = pd.merge(left=data, right=weather_since.loc[weather_since['경과일']>=0], how='right', left_on = ['년','월','일','시'], right_on=['년','월','일','시']).drop(['일시','대여소','일','휴일_x'], axis=1)"),r("br"),t._v("     data['대여횟수'] = data['대여횟수'].fillna(0)"),r("br"),t._v("     data['반납횟수'] = data['반납횟수'].fillna(0)"),r("br"),t._v("     data.columns = ['시', '대여횟수', '반납횟수', '년', '월', '기온', '강수량(mm)', '풍속(m/s)',"),r("br"),t._v("        '습도(%)', '전운량(10분위)', '안개', '비 또는 눈', '연무', '휴일', '경과일']"),r("br"),r("br"),t._v("     return data"),r("br")])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-002",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},d046:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("send-code",{attrs:{number:"33"}},[t._v(" fig = px.imshow(weather.corr().round(3), text_auto=True)"),r("br"),t._v(" fig.show() ")]),r("send-code",{attrs:{number:"34"}},[t._v(" fig = px.histogram(weather, x=\"기온\", histnorm='probability density')"),r("br"),t._v(" fig2 = px.histogram(weather, x=\"강수량(mm)\", histnorm='probability density')"),r("br"),t._v(" fig3 = px.histogram(weather, x=\"풍속(m/s)\", histnorm='probability density')"),r("br"),t._v(" fig4 = px.histogram(weather, x=\"전운량(10분위)\", histnorm='probability density')"),r("br"),t._v(" fig5 = px.histogram(weather, x=\"습도(%)\", histnorm='probability density')"),r("br"),t._v(" fig = pxMerger([fig, fig2, fig3,fig4,fig5], 3, 2)"),r("br"),t._v(" fig.update_layout("),r("br"),t._v("     height=700,"),r("br"),t._v("     width=1000,"),r("br"),t._v('     title_text="각 기상 관측치별 확률분포 히스토그램",'),r("br"),t._v("     xaxis1_title = '기온',"),r("br"),t._v("     xaxis2_title = '강수량(mm)',"),r("br"),t._v("     xaxis3_title = '풍속(m/s)',"),r("br"),t._v("     xaxis4_title = '전운량(10분위)',"),r("br"),t._v("     xaxis5_title = '습도(%)'"),r("br"),t._v("     )"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/weather_corr.html",width:"725",height:"730",type:"text/html"}})]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/weather_factors.html",width:"1025",height:"730",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 각 변수의 다중공선성은 걱정하지 않아도 되는 수준이다. 하지만 강수량, 습도, 전운량, 안개, 비가 서로 클러스터로 묶여있는 것을 볼 수 있다. 연역적으로도 도출 가능한 결론이다."),r("br"),r("br"),t._v(" 전운량은 데이터 성격 자체는 범주형 자료에 해당하나, 구름의 양을 수치화 한 것으로, 수치형 데이터로 해석한다. 기온, 풍속, 습도는 이상치가 없는 고른 분포를 하고 있음을 알 수 있다. 강수량의 경우에는 정규화를 진행할 때, 0에 해당하는 값이 너무 많아서 StandardScaler로 정규화 하더라도, 그렇게 큰 변화가 있지 않았고 Box-cox변환을 수행할 경우에는 -36의 람다값이 나와 사실상 해석 불가능한 수치를 반환했다. 따라서 그냥 비가 내리는지 안내리는지가 더 중요한 요소라고 판단하여 MinMaxScaler로 정규화했다. 나머지 요소들도 모두 같은 방식으로 스케일링했다."),r("br"),r("br"),t._v(" 이제 비로소 준비가 되었다고 판단하여 머신러닝을 수행했다. ")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-008",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},d86b:function(t,e,r){var a=r("d039");t.exports=a((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}))},dca8:function(t,e,r){var a=r("23e7"),s=r("bb2f"),o=r("d039"),i=r("861d"),n=r("f183").onFreeze,l=Object.freeze,_=o((function(){l(1)}));a({target:"Object",stat:!0,forced:_,sham:!s},{freeze:function(t){return l&&i(t)?l(n(t)):t}})},e1d3:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("send-code",{attrs:{number:"7"}},[t._v(" age_use_type = daily_use.groupby(['대여구분코드', '연령대','성별코드']).sum().unstack(fill_value=0).stack()['이용건수']"),r("br"),t._v(" fig = make_subplots(rows=3, cols=1)"),r("br"),t._v(" stack = ['정기', '일일권', '단체']"),r("br"),t._v(" age_code = ['10대미만', '10대', '20대', '30대', '40대', '50대', '60대','70대이상', '기타']"),r("br"),r("br"),t._v(" for i in range(3):"),r("br"),t._v("     fig.add_trace("),r("br"),t._v("         go.Bar("),r("br"),t._v('             name="None",'),r("br"),t._v("             x=age_code,"),r("br"),t._v("             y=age_use_type[stack[i]][age_use_type[stack[i]].index.get_level_values(1)=='None'].loc[age_code],"),r("br"),t._v("             offsetgroup=0,"),r("br"),t._v("             marker_color='red',"),r("br"),t._v("             legendgroup = i+1"),r("br"),t._v("         ),"),r("br"),t._v("         row=i+1,"),r("br"),t._v("         col=1,"),r("br"),t._v("     )"),r("br"),t._v("     fig.add_trace("),r("br"),t._v("         go.Bar("),r("br"),t._v('             name="남성",'),r("br"),t._v("             x=age_code,"),r("br"),t._v("             y=age_use_type[stack[i]][age_use_type[stack[i]].index.get_level_values(1)=='M'].loc[age_code],"),r("br"),t._v("             offsetgroup=0,"),r("br"),t._v("             base=age_use_type[stack[i]][age_use_type[stack[i]].index.get_level_values(1)=='None'].loc[age_code],"),r("br"),t._v("             marker_color='blue',"),r("br"),t._v("             legendgroup = i+1"),r("br"),t._v("         ),"),r("br"),t._v("         row=i+1,"),r("br"),t._v("         col=1,"),r("br"),r("br"),t._v("     )"),r("br"),t._v("     fig.add_trace("),r("br"),t._v("         go.Bar("),r("br"),t._v('             name="여성",'),r("br"),t._v("             x=age_code,"),r("br"),t._v("             y=age_use_type[stack[i]][age_use_type[stack[i]].index.get_level_values(1)=='F'].loc[age_code],"),r("br"),t._v("             offsetgroup=0,"),r("br"),t._v("             base=age_use_type[stack[i]][age_use_type[stack[i]].index.get_level_values(1)=='M'].loc[age_code]+age_use_type[stack[i]][age_use_type[stack[i]].index.get_level_values(1)=='None'].loc[age_code],"),r("br"),t._v("             marker_color='green',"),r("br"),t._v("             legendgroup = i+1"),r("br"),t._v("         ),"),r("br"),t._v("         row=i+1,"),r("br"),t._v("         col=1,"),r("br"),r("br"),t._v("     )"),r("br"),t._v("     fig.update_layout("),r("br"),t._v("     height=1000,"),r("br"),t._v("     width=800,"),r("br"),t._v('     title_text="대여종류별 연령&성별 차트",'),r("br"),t._v("     xaxis3_title = '연령대',"),r("br"),t._v("     yaxis1_title = '정기권',"),r("br"),t._v("     yaxis2_title = '일일권',"),r("br"),t._v("     yaxis3_title = '단체',"),r("br"),t._v("     legend_tracegroupgap = 240"),r("br"),r("br"),t._v("     )"),r("br"),r("br"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/age_use_type.html",width:"825",height:"1030",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v("각 대여종류별로 연령, 성별에 따른 이용의 추이를 보면 다음과 같다. 일일권은 압도적으로 20대가 많이 구매했는데, 보통 늦은 시간까지 귀가하지 않고 놀다가 집에 갈때 일일권을 사서 택시 대신 타고 가는 경우를 많이 봤다. 일일권 자체가 '자주타지는 않을 것이지만 지금은 필요한'경우에 사게 될 것이므로 이러한 경우가 두각될 것이다."),r("br"),r("br"),t._v(" 30대의 단체권 비율은 눈에 띄게 낮았다. 아마 단체로 무언가를 하기가 쉽지 않은 나이라 그런 것 같다. 따릉이 단체권은 통상의 단체권과 달리 2~5명을 대상으로 하고, 일일권과 1인당 가격이 같다. 따라서 굳이 단체권을 사야할 필요는 결코 없다. 여러명이 타려는데 휴대폰을 사용할 수 있는 인원에 제한이 있는 경우에 빛을 발할 것이다. ")])]),r("send-code",{attrs:{number:"8"}},[t._v(" monthly_use = daily_use[(daily_use['연']==2021)].loc[:,['대여일자','이용건수','대여구분코드', '성별코드', '이동거리(m)','이용시간(분)','대여요일']].groupby('대여일자').sum()"),r("br"),t._v(" monthly_use['평균이용시간(분)'] = monthly_use['이용시간(분)']/monthly_use['이용건수']"),r("br"),t._v(" monthly_use['평균이동거리(m)'] = monthly_use['이동거리(m)']/monthly_use['이용건수']"),r("br"),r("br"),t._v(" monthly_use = monthly_use.reset_index()"),r("br"),t._v(" monthly_use['대여일자'] = pd.to_datetime(monthly_use['대여일자'])"),r("br"),t._v(" monthly_use['대여요일'] = monthly_use['대여일자'].dt.dayofweek"),r("br"),t._v(" monthly_use['대여주']= monthly_use['대여일자'].dt.weekofyear.astype('category')"),r("br"),t._v(" monthly_use['대여월']=monthly_use['대여일자'].dt.month.astype('category')"),r("br"),t._v(" monthly_use['대여년']=monthly_use['대여일자'].dt.year.astype('category')"),r("br"),t._v(" monthly_use['대여요일'] = monthly_use.loc[:,'대여요일'].replace({0:'월', 1:'화', 2:\"수\", 3:'목', 4:'금', 5:'토', 6:'일'})"),r("br"),r("br"),t._v(" N=12"),r("br"),t._v(" c = ['hsl('+str(h)+',50%'+',50%)' for h in np.linspace(0, 360, N)]"),r("br"),t._v(" fig = go.Figure(data=[go.Box("),r("br"),t._v("     y=monthly_use[monthly_use['대여월']==i+1]['이용건수'],"),r("br"),t._v("     marker_color=c[i],"),r("br"),t._v("     name= str(i+1)+'월'"),r("br"),t._v("     ) for i in range(int(N))])"),r("br"),r("br"),t._v(" # format the layout"),r("br"),t._v(" fig.update_layout("),r("br"),t._v("     xaxis=dict(showgrid=False, zeroline=False, showticklabels=False),"),r("br"),t._v("     yaxis=dict(zeroline=False, gridcolor='white'),"),r("br"),t._v("     title='월별 자전거 이용량'"),r("br"),t._v(" )"),r("br"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/monthly_use.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 월별 이용량 그래프도 월별 신규 가입자 그래프와 같은 형태를 보이는 것을 볼 수 있다. 겨울에는 더 적은 수를 이용하고, 여름에는 더 많이 이용한다. 논리적인 순서는 반대일 것이다. 겨울에 이용압력이 더 적기 때문에, 이용량이 더 낮고, 그렇기 때문에 신규 가입인원이 적은 것이다."),r("br"),r("br"),t._v(" 위 그래프에서 재밌는 점이 있는데, 이상치가 아래쪽으로만 존재하고, 위쪽으로는(많은 이용량을 가지는 이상치는) 존재하지 않는다는 것이다. 이상치가 아래쪽으로 편중되는 이유는 비가 내리는 날에는 확실히 사람들이 자전거를 덜 타기 때문이다."),r("br"),r("br"),t._v(" 대여구분코드는 어떤 차이를 보여줄지 확인해보자 ")])]),r("send-code",{attrs:{number:"9"}},[t._v(" daily_use_df = daily_use[(daily_use['연']==2021)].loc[:,['대여일자','이용건수','대여구분코드', '성별코드', '이동거리(m)','이용시간(분)','대여요일']].groupby(['대여일자', '대여구분코드']).sum()"),r("br"),t._v(" daily_use_df = daily_use_df.reset_index()"),r("br"),t._v(" daily_use_df['대여일자'] = pd.to_datetime(daily_use_df['대여일자'])"),r("br"),t._v(" daily_use_df['대여요일'] = daily_use_df['대여일자'].dt.dayofweek"),r("br"),t._v(" daily_use_df['대여주']= daily_use_df['대여일자'].dt.weekofyear.astype('category')"),r("br"),t._v(" daily_use_df['대여월']=daily_use_df['대여일자'].dt.month.astype('category')"),r("br"),t._v(" daily_use_df['대여년']=daily_use_df['대여일자'].dt.year.astype('category')"),r("br"),t._v(" daily_use_df['대여요일'] = daily_use_df.loc[:,'대여요일'].replace({0:'월', 1:'화', 2:\"수\", 3:'목', 4:'금', 5:'토', 6:'일'})"),r("br"),r("br"),t._v(" monthly_use_type = daily_use_df.groupby(['대여월','대여구분코드']).sum().reset_index()"),r("br"),t._v(" fig = px.bar(monthly_use_type.loc[:,['대여월','대여구분코드','이용건수']], x='대여월', y='이용건수', color='대여구분코드', title=\"월별 대여구분코드에 따른 이용건수\")"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/monthly_use_type.html",width:"800",height:"500",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 정기, 일일권, 비회원, 단체에 의한 이용 모두 1월에 제일 적고 9월에 제일 많다. 사실 필자는 따릉이를 탐에 있어 계절을 별로 가리지 않기 때문에 정기권 층의 조금 더 결속된 모습을 기대했으나, 그러지는 않았다. 그럼에도 불구하고 정기권을 구매한 층이 겨울에도 덜 이탈하는 경향을 보였다. 정기권의 경우에는 1월에 60만건, 9월에 270만건으로 4.5배의 차이가 난다. 일일권의 경우에는 1월에 13만건, 9월에 80만건으로 약 6배의 차이가 난다. 비슷하게 비회원은 25배, 단체는 8배의 차이가 난다."),r("br"),r("br"),t._v(" 1월에 단체로 자전거를 타러가는 집단은 조금 이상한(최소한 흔하지는 않은) 집단일 확률이 높다는 것을 알 수 있다. 정기권일수록, 자전거에 진심이거나, 또는 정기권을 구매했다는 사실 자체에서 압력을 받아 1월에도 이용을 더 많이 하게 되는 경향성을 확인할 수 있다. ")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-002",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports},e41c:function(t,e,r){},f183:function(t,e,r){var a=r("23e7"),s=r("e330"),o=r("d012"),i=r("861d"),n=r("1a2d"),l=r("9bf2").f,_=r("241c"),d=r("057f"),c=r("4fad"),b=r("90e3"),v=r("bb2f"),u=!1,p=b("meta"),m=0,f=function(t){l(t,p,{value:{objectID:"O"+m++,weakData:{}}})},h=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!n(t,p)){if(!c(t))return"F";if(!e)return"E";f(t)}return t[p].objectID},g=function(t,e){if(!n(t,p)){if(!c(t))return!0;if(!e)return!1;f(t)}return t[p].weakData},y=function(t){return v&&u&&c(t)&&!n(t,p)&&f(t),t},x=function(){w.enable=function(){},u=!0;var t=_.f,e=s([].splice),r={};r[p]=1,t(r).length&&(_.f=function(r){for(var a=t(r),s=0,o=a.length;s<o;s++)if(a[s]===p){e(a,s,1);break}return a},a({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:d.f}))},w=t.exports={enable:x,fastKey:h,getWeakData:g,onFreeze:y};o[p]=!0},f464:function(t,e,r){"use strict";r("945c")},f6cd:function(t,e,r){"use strict";r("970e")},fdca:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{staticClass:"pt-4"},[r("send-code",{attrs:{number:"25"}},[t._v(" hour_2021_대여['유입량'] = hour_2021_반납['이용횟수']-hour_2021_대여['이용횟수']"),r("br"),r("br"),t._v(" weekday_lent_state = (-1) * hour_2021_대여.groupby(['요일','시']).mean().loc['평일']['유입량'].cumsum()"),r("br"),t._v(" weekday_lent_state = weekday_lent_state - weekday_lent_state.min()"),r("br"),t._v(" weekday_lent_state.name = '평일 대여상태'"),r("br"),t._v(" weekend_lent_state = (-1) * hour_2021_대여.groupby(['요일','시']).mean().loc['휴일']['유입량'].cumsum()"),r("br"),t._v(" weekend_lent_state = weekend_lent_state - weekend_lent_state.min()"),r("br"),t._v(" weekend_lent_state.name = '휴일 대여상태'"),r("br"),r("br"),r("br"),t._v(" fig = pxMerger([px.line(weekday_lent_state),px.line(weekend_lent_state)], 2, 1)"),r("br"),t._v(" fig.update_layout("),r("br"),t._v("     title='시간별 대여소당 자전거 대여상태 추이',"),r("br"),t._v("     legend_tracegroupgap = 400)"),r("br"),t._v(' fig.update_xaxes(title_text="시")'),r("br"),t._v(' fig.update_yaxes(title_text="대여숫자")'),r("br"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/weekday_lent_state.html",width:"925",height:"930",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 반납량과 대여량의 차이인 유입량이라는 항목을 만들었다. 이 항목은 앞으로 매우 중요하게 다뤄질 것이다. 또한 한 대여소에 존재하는 자전거의 대수는 유입량의 누적합과 같을 것이므로(정확히는 적분 상수만큼 차이가 난다) 대여소의 자전거 대수를 예측하는 것은 이러한 방식으로 간접적으로 구해질 것이다."),r("br"),r("br"),r("strong",[t._v(" 반납량-대여량=유입량"),r("br"),t._v(" 대여상태=유입량의 누적합"),r("br"),r("br")]),t._v(" 평일의 경우 이용하는 사람의 총 수는 8시에 피크를 찍었지만, 대여상태의 숫자(현재 이용중인 총 숫자)는 오전 7시에 급격하게 증가했다가 9시까지 매우 약간 감소한 후, 18시까지 계속 상승했다. 이는 길거리에서 따릉이를 볼 확률이 사람이 붐비는 8시나 9시나 별 다름없다는 것을 의미하지는 않는다. 왜냐하면 8시에 빌려서 다시 반납하는 이용객이 많다는 것을 위에서 확인했기 때문이다. 그러나 이는 따릉이를 빌리기위해 대여소에 갔을 경우 8시나 9시나 비슷하게 대여소에 따릉이가 남아있을 것이라는 것을 의미한다. 이것만으로도 조금 놀라운 결과이다."),r("br"),r("br"),t._v(" 하지만 정말 그럴까? 사람들은 주거지역에서 상업지역으로 출근하는 경향이 있으므로 자치구의 그 비율에 따라 차이를 보일 것이다. ")])]),r("send-code",{attrs:{number:"26"}},[t._v(' fig = px.density_heatmap(pd.concat([hour_2021_대여, hour_2021_반납]), x="시", y="자치구", z="이용횟수", facet_row="요일", facet_col=\'상태\', histfunc="avg")'),r("br"),t._v(" fig.update_layout(   "),r("br"),r("br"),t._v("     width=1200,"),r("br"),t._v("     height = 800,"),r("br"),t._v("     title='자치구별 시간별 대여소당 자전거 대여/반납 추이')"),r("br"),t._v(" fig.show()"),r("br")]),r("div",{staticClass:"d-flex justify-content-center"},[r("object",{staticClass:"frame",attrs:{data:"http://localhost:8000/static/figures/dist_hourly_use.html",width:"1225",height:"830",type:"text/html"}})]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" 다음은 자치구별 평일과 휴일의 시간당 대여/반납량을 나타낸 히트맵이다. 자치구가 많아 개별 자치구의 추이는 눈에 잘 들어오지않지만 전체적인 추세는 파악할 수 있다. 모든 자치구에서 평일 오전 8시, 18시가 피크임을 확인할 수 있다. 대여를 많이하는 자치구는 반납도 많이 하는 경향이 있음을 확인할 수 있다. ")])]),r("send-code",{attrs:{number:"27"}},[t._v(" pd.concat([hour_2021_대여.groupby(['요일','시','자치구']).mean()"),r("br"),t._v("     .loc['평일',8]['이용횟수'],hour_2021_반납.groupby(['요일','시','자치구'])"),r("br"),t._v("     .mean().loc['평일',8]['이용횟수']],axis=1)"),r("br"),t._v("     .corr(method ='pearson').iloc[0,1]"),r("br")]),r("receive-code",[t._v(" 0.8544188162665571 ")]),r("send-code",{attrs:{number:"28"}},[t._v(" (plotdf_2021['대여자치구']==plotdf_2021['반납자치구']).value_counts() ")]),r("receive-code",[t._v(" True     18876830"),r("br"),t._v(" False     7318823"),r("br"),t._v(" dtype: int64"),r("br")]),r("div",{staticClass:"typography-line pt-5"},[r("p",[t._v(" pearson 상관계수를 측정하면 평일 오전 8시의 자치구별 대여와 반납횟수 사이에서 0.8515의 높은 상관계수를 볼 수 있다. 즉 대여량이 더 많은 자치구가 반납량도 더 많다. 여기에는 두가지 가능성이 있다."),r("br"),r("ol",[r("li",[t._v("대부분의 자전거 이동은 자치구 내 이동이다.")]),r("li",[t._v("실제로 '따릉이를 빌리기위해 대여소에 갔을 경우 8시나 9시나 비슷하게 대여소에 따릉이가 남아있을 것'이다.")])]),t._v(" 1에 대한 확인은 비교적 쉽게 할 수 있다. 대략 72%의 이동이 자치구 내에서 일어나는 것을 알 수 있다. "),r("br"),r("br"),t._v(" 대여량과 반납량이 상관관계를 보이는 이유는 자치구 자체가 점이 아니라 크기를 가지고 있는 지역이므로 한 출발지로부터 이동하는 이용객이 그리 멀리 떨어지지 않은 곳에(같은 자치구 안에) 반납을 할 가능성이 높기 때문인 것으로 판명났다. 주의하지 않으면 잘못된 결론에 빠지기 쉽다. ")])])],1)},s=[],o=r("f8c7"),i=r("8692"),n={name:"dynamic-007",components:{sendCode:o["a"],receiveCode:i["a"]},data:function(){return{}}},l=n,_=r("2877"),d=Object(_["a"])(l,a,s,!1,null,null,null);e["default"]=d.exports}}]);
//# sourceMappingURL=pages.594973c0.js.map